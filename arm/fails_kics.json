{
	"kics_version": "1.4.9",
	"files_scanned": 40,
	"files_parsed": 40,
	"files_failed_to_scan": 0,
	"queries_total": 42,
	"queries_failed_to_execute": 0,
	"queries_failed_to_compute_similarity_id": 0,
	"scan_id": "console",
	"severity_counters": {
		"HIGH": 65,
		"INFO": 9,
		"LOW": 29,
		"MEDIUM": 37,
		"TRACE": 0
	},
	"total_counter": 140,
	"total_bom_resources": 0,
	"start": "2022-02-19T09:51:42.5111688Z",
	"end": "2022-02-19T09:51:49.1851948Z",
	"paths": [
		".\\arm\\"
	],
	"queries": [
		{
			"query_name": "Azure Instance Using Basic Authentication",
			"query_id": "6797f581-0433-4768-ae3e-7ceb2f8b138e",
			"query_url": "https://docs.microsoft.com/en-us/azure/templates/microsoft.compute/virtualmachines?tabs=json#linuxconfiguration-object",
			"severity": "HIGH",
			"platform": "AzureResourceManager",
			"category": "Best Practices",
			"description": "Azure Instances should use SSH Key instead of basic authentication",
			"description_id": "98ba05ca",
			"files": [
				{
					"file_name": "arm\\example_AzureManagedDiscEncryption\\azureManagedDiscEncryption-FAILED.json",
					"similarity_id": "bd038089d6bc072f26f7ec446b5aa9f21937e7d06bc54d0949421a29597389cb",
					"line": 311,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name=[variables('Front VM')]",
					"search_line": 0,
					"search_value": "",
					"expected_value": "'disablePasswordAuthentication' is set to true",
					"actual_value": "'disablePasswordAuthentication' is undefined"
				},
				{
					"file_name": "arm\\example_NSGRuleSSHAccessRestricted\\NSGRulePortAccessRestricted-FAILED.json",
					"similarity_id": "d13775bda925732c54aaed8596b9a9fe6ea648fe04859642be576454c2c0834e",
					"line": 201,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name=[variables('jumpBoxName')]",
					"search_line": 0,
					"search_value": "",
					"expected_value": "'disablePasswordAuthentication' is set to true",
					"actual_value": "'disablePasswordAuthentication' is undefined"
				},
				{
					"file_name": "arm\\example_AzureManagedDiscEncryption\\azureManagedDiscEncryption-FAILED.json",
					"similarity_id": "b54070d059b73970eb343d83530baff59ab50248ee4a138d49954beef6e45800",
					"line": 433,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name=[variables('Front VM Clone')]",
					"search_line": 0,
					"search_value": "",
					"expected_value": "'disablePasswordAuthentication' is set to true",
					"actual_value": "'disablePasswordAuthentication' is undefined"
				},
				{
					"file_name": "arm\\example_AzureInstancePassword\\FAILED.json",
					"similarity_id": "090a876e831043689768a4a83741bafc07da3be538bf86995ca721ec7cd47c89",
					"line": 208,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name=default",
					"search_line": 0,
					"search_value": "",
					"expected_value": "'disablePasswordAuthentication' is set to true",
					"actual_value": "'disablePasswordAuthentication' is undefined"
				},
				{
					"file_name": "arm\\example_NSGRuleRDPAccessRestricted\\NSGRulePortAccessRestricted-FAILED.json",
					"similarity_id": "ee8e60d1c7717a03579c50c068dd7eafa738ddbd7bb386888a01727de6f82dcf",
					"line": 201,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name=[variables('jumpBoxName')]",
					"search_line": 0,
					"search_value": "",
					"expected_value": "'disablePasswordAuthentication' is set to true",
					"actual_value": "'disablePasswordAuthentication' is undefined"
				}
			]
		},
		{
			"query_name": "Azure Managed Disk Without Encryption",
			"query_id": "350f3955-b5be-436f-afaa-3d2be2fa6cdd",
			"query_url": "https://docs.microsoft.com/en-us/azure/templates/microsoft.compute/disks?tabs=json#encryptionsettingscollection-object",
			"severity": "HIGH",
			"platform": "AzureResourceManager",
			"category": "Encryption",
			"description": "Azure Disk Encryption should be enabled",
			"description_id": "e2fa6cda",
			"cis_description_id": "CIS Security - CIS Microsoft Azure Foundations Benchmark v1.3.1 - Rule 7.2",
			"cis_description_title": "Ensure that 'OS and Data' disks are encrypted with CMK",
			"cis_description_text": "Ensure that OS disks (boot volumes) and data disks (non-boot volumes) are encrypted with CMK.\nEncrypting the IaaS VM's OS disk (boot volume), Data disks (non-boot volume) ensures that the entire content is fully unrecoverable without a key and thus protects the volume from unwarranted reads. CMK is superior encryption although requires additional planning.",
			"files": [
				{
					"file_name": "arm\\example_AzureManagedDiscEncryption\\azureManagedDiscEncryption-FAILED.json",
					"similarity_id": "c4d099cbbfc611389494f7e84031550e2953cee78eb2c77c4e4df4991ccd9b48",
					"line": 373,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name=[variables('Front VM Clone')]",
					"search_line": 0,
					"search_value": "",
					"expected_value": "'encryptionSettingsCollection.enabled' is set to true",
					"actual_value": "'encryptionSettingsCollection.enabled' is undefined"
				}
			]
		},
		{
			"query_name": "Key Vault Not Recoverable",
			"query_id": "7c25f361-7c66-44bf-9b69-022acd5eb4bd",
			"query_url": "https://docs.microsoft.com/en-us/azure/templates/microsoft.keyvault/2019-09-01/vaults?tabs=json#vaultproperties-object",
			"severity": "HIGH",
			"platform": "AzureResourceManager",
			"category": "Backup",
			"description": "Key Vault should have 'enableSoftDelete' and 'enablePurgeProtection' set to true",
			"description_id": "8e3ca202",
			"cis_description_id": "CIS Security - CIS Microsoft Azure Foundations Benchmark v1.3.1 - Rule 8.4",
			"cis_description_title": "Ensure the key vault is recoverable",
			"cis_description_text": "The key vault contains object keys, secrets and certificates. Accidental unavailability of a key vault can cause immediate data loss or loss of security functions (authentication, validation, verification, non-repudiation, etc.) supported by the key vault objects. It is recommended the key vault be made recoverable by enabling the \"Do Not Purge\" and \"Soft Delete\" functions. This is in order to prevent loss of encrypted data including storage accounts, SQL databases, and/or dependent services provided by key vault objects (Keys, Secrets, Certificates) etc., as may happen in the case of accidental deletion by a user or from disruptive activity by a malicious user.\nThere could be scenarios where users accidently run delete/purge commands on key vault or attacker/malicious user does it deliberately to cause disruption.Deleting or purging a key vault leads to immediate data loss as keys encrypting data and secrets/certificates allowing access/services will become non-accessible.There are 2 key vault properties that plays role in permanent unavailability of a key vault. enableSoftDelete : Setting this parameter to true for a key vault ensures that even if key vault is deleted, Key vault itself or its objects remain recoverable for next 90days. In this span of 90 days either key vault/objects can be recovered or purged (permanent deletion). If no action is taken, after 90 days key vault and its objects will be purged. enablePurgeProtection : enableSoftDelete only ensures that key vault is not deleted permanently and will be recoverable for 90 days from date of deletion. However, there are chances that the key vault and/or its objects are accidentally purged and hence will not be recoverable. Setting enablePurgeProtection to \"true\" ensures that the key vault and its objects cannot be purged. Enabling both the parameters on key vaults ensures that key vaults and their objects cannot be deleted/purged permanently.",
			"files": [
				{
					"file_name": "arm\\example_KeyvaultRecoveryEnabled\\keyvaultRecoveryEnabled-FAILED.json",
					"similarity_id": "9020e3425f24e5265dafc4b4f1c2747601afc12def3ab2d8e64d2fbe77ab2480",
					"line": 112,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{[parameters('keyVaultName')]}}.properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.KeyVault/vaults' has 'enablePurgeProtection' property defined",
					"actual_value": "resource with type 'Microsoft.KeyVault/vaults' doesn't have 'enablePurgeProtection' property defined"
				},
				{
					"file_name": "arm\\example_KeyvaultRecoveryEnabled\\keyvaultRecoveryEnabled-FAILED.json",
					"similarity_id": "9020e3425f24e5265dafc4b4f1c2747601afc12def3ab2d8e64d2fbe77ab2480",
					"line": 112,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{[parameters('keyVaultName')]}}.properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.KeyVault/vaults' has 'enableSoftDelete' property defined",
					"actual_value": "resource with type 'Microsoft.KeyVault/vaults' doesn't have 'enableSoftDelete' property defined"
				},
				{
					"file_name": "arm\\example_SecretExpirationDate\\SecretExpirationDate-FAILED.json",
					"similarity_id": "ff7735a2d06ff26c918534bdb333a0cc2ff36789a37aed5f1ee77bfbe141026d",
					"line": 112,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{[parameters('keyVaultName')]}}.properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.KeyVault/vaults' has 'enableSoftDelete' property defined",
					"actual_value": "resource with type 'Microsoft.KeyVault/vaults' doesn't have 'enableSoftDelete' property defined"
				},
				{
					"file_name": "arm\\example_SecretExpirationDate\\SecretExpirationDate-FAILED.json",
					"similarity_id": "ff7735a2d06ff26c918534bdb333a0cc2ff36789a37aed5f1ee77bfbe141026d",
					"line": 112,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{[parameters('keyVaultName')]}}.properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.KeyVault/vaults' has 'enablePurgeProtection' property defined",
					"actual_value": "resource with type 'Microsoft.KeyVault/vaults' doesn't have 'enablePurgeProtection' property defined"
				}
			]
		},
		{
			"query_name": "MySQL Server SSL Enforcement Disabled",
			"query_id": "90120147-f2e7-4fda-bb21-6fa9109afd63",
			"query_url": "https://docs.microsoft.com/en-us/azure/templates/microsoft.dbformysql/servers?tabs=json#serverpropertiesforcreate-object",
			"severity": "HIGH",
			"platform": "AzureResourceManager",
			"category": "Networking and Firewall",
			"description": "'Microsoft.DBforMySQL/servers' should enforce SSL",
			"description_id": "69fea5b1",
			"cis_description_id": "CIS Security - CIS Microsoft Azure Foundations Benchmark v1.3.1 - Rule 4.3.2",
			"cis_description_title": "Ensure 'Enforce SSL connection' is set to 'ENABLED' for MySQL Database Server",
			"cis_description_text": "Enable SSL connection on MYSQL Servers.\nSSL connectivity helps to provide a new layer of security, by connecting database server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between database server and client applications helps protect against \"man in the middle\" attacks by encrypting the data stream between the server and application.",
			"files": [
				{
					"file_name": "arm\\example_MySQLServerSSLEnforcementEnabled\\mysqlSSLEnforcementEnabled-FAILED.json",
					"similarity_id": "c8fd40f27ecef8509a253eb50c5df032ae0be2c4a229bb9bfad25e91341cd9c3",
					"line": 186,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{[parameters('serverName')]}}.properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.DBforMySQL/servers' has the 'sslEnforcement' property defined",
					"actual_value": "resource with type 'Microsoft.DBforMySQL/servers' doesn't have 'sslEnforcement' property defined"
				}
			]
		},
		{
			"query_name": "Network Security Group With Unrestricted Access To RDP",
			"query_id": "59cb3da7-f206-4ae6-b827-7abf0a9cab9d",
			"query_url": "https://docs.microsoft.com/en-us/azure/templates/microsoft.network/2020-07-01/networksecuritygroups?tabs=json#securityrulepropertiesformat-object",
			"severity": "HIGH",
			"platform": "AzureResourceManager",
			"category": "Networking and Firewall",
			"description": "Port 3389 (Remote Desktop) is exposed to the Internet",
			"description_id": "e09bde32",
			"cis_description_id": "CIS Security - CIS Microsoft Azure Foundations Benchmark v1.3.1 - Rule 6.1",
			"cis_description_title": "Ensure that RDP access is restricted from the internet",
			"cis_description_text": "Disable RDP access on network security groups from the Internet.\nThe potential security problem with using RDP over the Internet is that attackers can use various brute force techniques to gain access to Azure Virtual Machines. Once the attackers gain access, they can use a virtual machine as a launch point for compromising other machines on an Azure Virtual Network or even attack networked devices outside of Azure.",
			"files": [
				{
					"file_name": "arm\\example_NSGRuleRDPAccessRestricted\\NSGRulePortAccessRestricted-FAILED.json",
					"similarity_id": "9a65f9250a23bc0565a4596e7c2b976a4c0b7c3311bb45cc69e72c19ab4c5719",
					"line": 111,
					"issue_type": "IncorrectValue",
					"search_key": "resources.name={{[variables('networkSecurityGroupName')]}}.properties.securityRules",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Network/networkSecurityGroups' restricts access to RDP",
					"actual_value": "resource with type 'Microsoft.Network/networkSecurityGroups' does not restrict access to RDP"
				},
				{
					"file_name": "arm\\example_StorageAccountAzureServicesAccessEnabled\\storageAccountAzureServicesAccessEnabled-FAILED.json",
					"similarity_id": "f96a67f6d40c5a1a4c5f6d3c767dc0b78c2bf39fd6261e282ff5af3b9132544c",
					"line": 108,
					"issue_type": "IncorrectValue",
					"search_key": "resources.name={{[variables('networkSecurityGroupName')]}}.properties.securityRules",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Network/networkSecurityGroups' restricts access to RDP",
					"actual_value": "resource with type 'Microsoft.Network/networkSecurityGroups' does not restrict access to RDP"
				},
				{
					"file_name": "arm\\example_StorageAccountDefaultNetworkAccessDeny\\storageAccountDefaultNetworkAccessDeny-FAILED.json",
					"similarity_id": "3e36f9d711f45ccff8c7e7acf449932443cce561873f193b2743646c39892139",
					"line": 108,
					"issue_type": "IncorrectValue",
					"search_key": "resources.name={{[variables('networkSecurityGroupName')]}}.properties.securityRules",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Network/networkSecurityGroups' restricts access to RDP",
					"actual_value": "resource with type 'Microsoft.Network/networkSecurityGroups' does not restrict access to RDP"
				}
			]
		},
		{
			"query_name": "Network Security Group With Unrestricted Access To SSH",
			"query_id": "2ade1579-4b2c-4590-bebb-f99bf597f612",
			"query_url": "https://docs.microsoft.com/en-us/azure/templates/microsoft.network/2020-07-01/networksecuritygroups?tabs=json#securityrulepropertiesformat-object",
			"severity": "HIGH",
			"platform": "AzureResourceManager",
			"category": "Networking and Firewall",
			"description": "Port 22 (SSH) is exposed to the Internet",
			"description_id": "97b6233c",
			"cis_description_id": "CIS Security - CIS Microsoft Azure Foundations Benchmark v1.3.1 - Rule 6.2",
			"cis_description_title": "Ensure that SSH access is restricted from the internet",
			"cis_description_text": "Disable SSH access on network security groups from the Internet.\nThe potential security problem with using SSH over the Internet is that attackers can use various brute force techniques to gain access to Azure Virtual Machines. Once the attackers gain access, they can use a virtual machine as a launch point for compromising other machines on the Azure Virtual Network or even attack networked devices outside of Azure.",
			"files": [
				{
					"file_name": "arm\\example_AKSNetworkPolicy\\aksNetworkPolicy-FAILED.json",
					"similarity_id": "5a7674336d38524e72e06d8d8cb0f796c3616caea0983b9aa34667203bf85833",
					"line": 244,
					"issue_type": "IncorrectValue",
					"search_key": "resources.name={{[variables('frontEndNSGName')]}}.properties.securityRules",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Network/networkSecurityGroups' restricts access to SSH",
					"actual_value": "resource with type 'Microsoft.Network/networkSecurityGroups' does not restrict access to SSH"
				},
				{
					"file_name": "arm\\example_NSGRuleSSHAccessRestricted\\NSGRulePortAccessRestricted-FAILED.json",
					"similarity_id": "dacbd1093a550953611fce9dee9a4731c97bd324ed4503a5060c3b9ee6ea4be9",
					"line": 111,
					"issue_type": "IncorrectValue",
					"search_key": "resources.name={{[variables('networkSecurityGroupName')]}}.properties.securityRules",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Network/networkSecurityGroups' restricts access to SSH",
					"actual_value": "resource with type 'Microsoft.Network/networkSecurityGroups' does not restrict access to SSH"
				},
				{
					"file_name": "arm\\example_AzureManagedDiscEncryption\\azureManagedDiscEncryption-FAILED.json",
					"similarity_id": "a44f655a74f28af0dd1c3e65b035d31a6874409f5b972604fad8e509295b3767",
					"line": 188,
					"issue_type": "IncorrectValue",
					"search_key": "resources.name={{frontNsg}}.properties.securityRules",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Network/networkSecurityGroups' restricts access to SSH",
					"actual_value": "resource with type 'Microsoft.Network/networkSecurityGroups' does not restrict access to SSH"
				},
				{
					"file_name": "arm\\example_AKSLoggingEnabled\\aksLoggingEnabled-FAILED.json",
					"similarity_id": "ee261974f7698950d784a8c32dcb9f52a83bc91602b8eb01b22c84d19bbdd3c5",
					"line": 244,
					"issue_type": "IncorrectValue",
					"search_key": "resources.name={{[variables('frontEndNSGName')]}}.properties.securityRules",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Network/networkSecurityGroups' restricts access to SSH",
					"actual_value": "resource with type 'Microsoft.Network/networkSecurityGroups' does not restrict access to SSH"
				},
				{
					"file_name": "arm\\example_AKSRbacEnabled\\aksEnableRbac-FAILED.json",
					"similarity_id": "c7dadd6944561a941fc1af14f85c03bde725e02672a88e4f516f228c81a08d7d",
					"line": 244,
					"issue_type": "IncorrectValue",
					"search_key": "resources.name={{[variables('frontEndNSGName')]}}.properties.securityRules",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Network/networkSecurityGroups' restricts access to SSH",
					"actual_value": "resource with type 'Microsoft.Network/networkSecurityGroups' does not restrict access to SSH"
				}
			]
		},
		{
			"query_name": "Passwords And Secrets - Generic Password",
			"query_id": "487f4be7-3fd9-4506-a07a-eae252180c08",
			"query_url": "https://kics.io/",
			"severity": "HIGH",
			"platform": "Common",
			"category": "Secret Management",
			"description": "Query to find passwords and secrets in infrastructure code.",
			"description_id": "d69d8a89",
			"files": [
				{
					"file_name": "arm\\example_MariaDBSSLEnforcementEnabled\\FAILED.json",
					"similarity_id": "cb0c34d2c29ee77e0a268c605f6a20f6e30b323b1725b516cea4ddf8f08dbc16",
					"line": 17,
					"issue_type": "RedundantAttribute",
					"search_key": "",
					"search_line": 0,
					"search_value": "",
					"expected_value": "Hardcoded secret key should not appear in source",
					"actual_value": "'        \"administratorLoginPassword\": \"admin123\",' contains a secret"
				},
				{
					"file_name": "arm\\example_AzureScaleSetPassword\\FAILED.json",
					"similarity_id": "508b686c1f62161fc69c6be36ed40ca64119c6fac61f1c268768364c4a7ba3e6",
					"line": 35,
					"issue_type": "RedundantAttribute",
					"search_key": "",
					"search_line": 0,
					"search_value": "",
					"expected_value": "Hardcoded secret key should not appear in source",
					"actual_value": "'              \"adminPassword\": \"P@ssw0rd!\"' contains a secret"
				}
			]
		},
		{
			"query_name": "PostgreSQL Database Server SSL Disabled",
			"query_id": "bf500309-da53-4dd3-bcf7-95f7974545a5",
			"query_url": "https://docs.microsoft.com/en-us/azure/templates/microsoft.dbforpostgresql/2017-12-01/servers?tabs=json",
			"severity": "HIGH",
			"platform": "AzureResourceManager",
			"category": "Networking and Firewall",
			"description": "Microsoft.DBforPostgreSQL/servers sslEnforcement property should be set to 'Enabled'",
			"description_id": "67cfaa3b",
			"cis_description_id": "CIS Security - CIS Microsoft Azure Foundations Benchmark v1.3.1 - Rule 4.1.2",
			"cis_description_title": "Ensure that 'Data encryption' is set to 'On' on a SQL Database",
			"cis_description_text": "Enable Transparent Data Encryption on every SQL server.\nAzure SQL Database transparent data encryption helps protect against the threat of malicious activity by performing real-time encryption and decryption of the database, associated backups, and transaction log files at rest without requiring changes to the application.",
			"files": [
				{
					"file_name": "arm\\example_PostgreSQLServerLogCheckpointsEnabled\\postgreSQL-LogCheckpointsEnabled-FAILED.json",
					"similarity_id": "708bfdb65c6d692d4e14c89dacc4263509fd3e23c83c2097b161cc50a47b1b00",
					"line": 174,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{[variables('serverName')]}}.properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.DBforPostgreSQL/servers' has 'sslEnforcement' property defined",
					"actual_value": "resource with type 'Microsoft.DBforPostgreSQL/servers' doesn't have 'sslEnforcement' property defined"
				},
				{
					"file_name": "arm\\example_PostgreSQLServerConnectionThrottlingEnabled\\postgreSQL-ConnectionThrottlingEnabled-FAILED.json",
					"similarity_id": "8467bfefde027275b83d98480b4f727f2682f30ba27f7027a0398dd999972c2d",
					"line": 174,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{[variables('serverName')]}}.properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.DBforPostgreSQL/servers' has 'sslEnforcement' property defined",
					"actual_value": "resource with type 'Microsoft.DBforPostgreSQL/servers' doesn't have 'sslEnforcement' property defined"
				},
				{
					"file_name": "arm\\example_PostgreSQLServerLogConnectionsEnabled\\postgreSQL-LogConnectionsEnabled-FAILED.json",
					"similarity_id": "14b1ce9f897243b755704f9a8a01beeb01cc5a4e47be69fc669401ea7466adf7",
					"line": 174,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{[variables('serverName')]}}.properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.DBforPostgreSQL/servers' has 'sslEnforcement' property defined",
					"actual_value": "resource with type 'Microsoft.DBforPostgreSQL/servers' doesn't have 'sslEnforcement' property defined"
				},
				{
					"file_name": "arm\\example_PostgreSQLServerSSLEnforcementEnabled\\postgreSQL-SSL-FAILED.json",
					"similarity_id": "242cf205c8cef4758143a2391eb42bac2c080bea139d60fc959ff209078ea659",
					"line": 188,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{[parameters('serverName')]}}.properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.DBforPostgreSQL/servers' has 'sslEnforcement' property defined",
					"actual_value": "resource with type 'Microsoft.DBforPostgreSQL/servers' doesn't have 'sslEnforcement' property defined"
				}
			]
		},
		{
			"query_name": "SQL Database Server Firewall Allows All IPS",
			"query_id": "6a3201a5-1630-494b-b294-3129d06b0eca",
			"query_url": "https://docs.microsoft.com/en-us/azure/templates/microsoft.sql/2014-04-01/servers/firewallrules?tabs=json",
			"severity": "HIGH",
			"platform": "AzureResourceManager",
			"category": "Networking and Firewall",
			"description": "SQL Database Server Firewall endIpAddress should not be '255.255.255.255' when startIpAddress is '0.0.0.0' since this allows all IPS",
			"description_id": "6664d4d6",
			"cis_description_id": "CIS Security - CIS Microsoft Azure Foundations Benchmark v1.3.1 - Rule 6.3",
			"cis_description_title": "Ensure no SQL Databases allow ingress 0.0.0.0/0 (ANY IP)",
			"cis_description_text": "Ensure that no SQL Databases allow ingress from 0.0.0.0/0 (ANY IP).\nSQL Server includes a firewall to block access to unauthorized connections. More granular IP addresses can be defined by referencing the range of addresses available from specific datacenters. By default, for a SQL server, a Firewall exists with StartIp of 0.0.0.0 and EndIP of 0.0.0.0 allowing access to all the Azure services. Additionally, a custom rule can be set up with StartIp of 0.0.0.0 and EndIP of 255.255.255.255 allowing access from ANY IP over the Internet. In order to reduce the potential attack surface for a SQL server, firewall rules should be defined with more granular IP addresses by referencing the range of addresses available from specific datacenters.",
			"files": [
				{
					"file_name": "arm\\example_PostgreSQLServerConnectionThrottlingEnabled\\postgreSQL-ConnectionThrottlingEnabled-FAILED.json",
					"similarity_id": "1a1aedc1209dab1d118ed9f99a72b91e5bfbda10fe38e891ec01cfb4010605cc",
					"line": 191,
					"issue_type": "IncorrectValue",
					"search_key": "resources.resources.name={{[concat(variables('serverName'),'firewall')]}}.properties.endIpAddress",
					"search_line": 0,
					"search_value": "",
					"expected_value": "endIpAddress is not '255.255.255.255' when startIpAddress is '0.0.0.0'",
					"actual_value": "endIpAddress is '255.255.255.255' and startIpAddress is '0.0.0.0'"
				},
				{
					"file_name": "arm\\example_SQLServerNoPublicAccess\\sqlServerNoPublicAccess-TDE-FAILED.json",
					"similarity_id": "542fb2bdfdea73f71695831fa1c8f13435bff49510cd149d78fdc7c48985304d",
					"line": 95,
					"issue_type": "IncorrectValue",
					"search_key": "resources.resources.name={{AllowAllMicrosoftAzureIps}}.properties.endIpAddress",
					"search_line": 0,
					"search_value": "",
					"expected_value": "endIpAddress is not '255.255.255.255' when startIpAddress is '0.0.0.0'",
					"actual_value": "endIpAddress is '255.255.255.255' and startIpAddress is '0.0.0.0'"
				},
				{
					"file_name": "arm\\example_PostgreSQLServerLogCheckpointsEnabled\\postgreSQL-LogCheckpointsEnabled-FAILED.json",
					"similarity_id": "fe9d8dd2a547b127417ca5856cd2a8232a3a4c000fd3ceccb27fa6f19a1abb5c",
					"line": 191,
					"issue_type": "IncorrectValue",
					"search_key": "resources.resources.name={{[concat(variables('serverName'),'firewall')]}}.properties.endIpAddress",
					"search_line": 0,
					"search_value": "",
					"expected_value": "endIpAddress is not '255.255.255.255' when startIpAddress is '0.0.0.0'",
					"actual_value": "endIpAddress is '255.255.255.255' and startIpAddress is '0.0.0.0'"
				},
				{
					"file_name": "arm\\example_PostgreSQLServerLogConnectionsEnabled\\postgreSQL-LogConnectionsEnabled-FAILED.json",
					"similarity_id": "f430cdf941f32b97038ab02a6f69dca1cd8fe84159b3576a110453b137f30daa",
					"line": 191,
					"issue_type": "IncorrectValue",
					"search_key": "resources.resources.name={{[concat(variables('serverName'),'firewall')]}}.properties.endIpAddress",
					"search_line": 0,
					"search_value": "",
					"expected_value": "endIpAddress is not '255.255.255.255' when startIpAddress is '0.0.0.0'",
					"actual_value": "endIpAddress is '255.255.255.255' and startIpAddress is '0.0.0.0'"
				}
			]
		},
		{
			"query_name": "Secret Without Expiration Date",
			"query_id": "cff9c3f7-e8f0-455f-9fb4-5f72326da96e",
			"query_url": "https://docs.microsoft.com/en-us/azure/templates/microsoft.keyvault/vaults/secrets?tabs=json#SecretAttributes",
			"severity": "HIGH",
			"platform": "AzureResourceManager",
			"category": "Best Practices",
			"description": "All Secrets must have an expiration date defined",
			"description_id": "bb5f96a2",
			"files": [
				{
					"file_name": "arm\\example_KeyvaultRecoveryEnabled\\keyvaultRecoveryEnabled-FAILED.json",
					"similarity_id": "197e72015de01648a955f9d41b47ef9385f9960b529faf2eaa56454ea9f28a6a",
					"line": 145,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{[concat(parameters('keyVaultName'), '/', parameters('secretName'))]}}.properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Security/securityContacts' has 'attributes.exp' property id defined",
					"actual_value": "resource with type 'Microsoft.Security/securityContacts' doesn't have 'attributes' property defined"
				},
				{
					"file_name": "arm\\example_SecretExpirationDate\\SecretExpirationDate-FAILED.json",
					"similarity_id": "ac8729fc041aa7b8092649aef6fdb6b5e47eabecabdf01751ea5882381652eaf",
					"line": 145,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{[concat(parameters('keyVaultName'), '/', parameters('secretName'))]}}.properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Security/securityContacts' has 'attributes.exp' property id defined",
					"actual_value": "resource with type 'Microsoft.Security/securityContacts' doesn't have 'attributes' property defined"
				}
			]
		},
		{
			"query_name": "Storage Account Allows Unsecure Transfer",
			"query_id": "1367dd13-2c90-4020-80b7-e4339a3dc2c4",
			"query_url": "https://docs.microsoft.com/en-us/azure/templates/microsoft.storage/storageaccounts?tabs=json#storageaccountpropertiescreateparameters-object",
			"severity": "HIGH",
			"platform": "AzureResourceManager",
			"category": "Encryption",
			"description": "'Microsoft.Storage/storageAccounts' should force the use of HTTPS",
			"description_id": "f87b26ea",
			"cis_description_id": "CIS Security - CIS Microsoft Azure Foundations Benchmark v1.3.1 - Rule 3.1",
			"cis_description_title": "Ensure that 'Secure transfer required' is set to 'Enabled'",
			"cis_description_text": "Enable data encryption in transit.\nThe secure transfer option enhances the security of a storage account by only allowing requests to the storage account by a secure connection. For example, when calling REST APIs to access storage accounts, the connection must use HTTPS. Any requests using HTTP will be rejected when 'secure transfer required' is enabled. When using the Azure files service, connection without encryption will fail, including scenarios using SMB 2.1, SMB 3.0 without encryption, and some flavors of the Linux SMB client. Because Azure storage doesn’t support HTTPS for custom domain names, this option is not applied when using a custom domain name.",
			"files": [
				{
					"file_name": "arm\\example_NSGRuleSSHAccessRestricted\\NSGRulePortAccessRestricted-FAILED.json",
					"similarity_id": "b20dc94f1ec4476fdc3f309a924baec8ed5232d60d757313f1c30afd7d08597e",
					"line": 157,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{[variables('jumpBoxSAName')]}}properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Storage/storageAccounts' has the 'supportsHttpsTrafficOnly' property defined",
					"actual_value": "resource with type 'Microsoft.Storage/storageAccounts' doesn't have 'supportsHttpsTrafficOnly' property defined"
				},
				{
					"file_name": "arm\\example_StorageAccountAzureServicesAccessEnabled\\storageAccountAzureServicesAccessEnabled-FAILED.json",
					"similarity_id": "677bee56eea360fd43778e38ee098a92ad0be4a241e1b5c385ec6ada2dc6c340",
					"line": 215,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{[variables('storageAccountName')]}}properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Storage/storageAccounts' has the 'supportsHttpsTrafficOnly' property defined",
					"actual_value": "resource with type 'Microsoft.Storage/storageAccounts' doesn't have 'supportsHttpsTrafficOnly' property defined"
				},
				{
					"file_name": "arm\\example_StorageAccountDefaultNetworkAccessDeny\\storageAccountDefaultNetworkAccessDeny-FAILED.json",
					"similarity_id": "6fb98a6ed8caeee17102816156d635a6ee1272c11fb6e7ce9b199f4af8740686",
					"line": 215,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{[variables('storageAccountName')]}}properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Storage/storageAccounts' has the 'supportsHttpsTrafficOnly' property defined",
					"actual_value": "resource with type 'Microsoft.Storage/storageAccounts' doesn't have 'supportsHttpsTrafficOnly' property defined"
				},
				{
					"file_name": "arm\\example_NSGRuleRDPAccessRestricted\\NSGRulePortAccessRestricted-FAILED.json",
					"similarity_id": "05d58d7df303b2227565c57fbbc7e0a3b8efadd68195d1959d3a2a774f37da05",
					"line": 157,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{[variables('jumpBoxSAName')]}}properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Storage/storageAccounts' has the 'supportsHttpsTrafficOnly' property defined",
					"actual_value": "resource with type 'Microsoft.Storage/storageAccounts' doesn't have 'supportsHttpsTrafficOnly' property defined"
				},
				{
					"file_name": "arm\\example_StorageAccountsTransportEncryption\\storageAccount-FAILED.json",
					"similarity_id": "a00dd49dda3b8829c4311a599e1eae47628938f6b7bda449da08b77c2c8eab34",
					"line": 40,
					"issue_type": "IncorrectValue",
					"search_key": "resources.name=[variables('storageAccountName')].properties.supportsHttpsTrafficOnly",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Storage/storageAccounts' has the 'supportsHttpsTrafficOnly' property set to true",
					"actual_value": "resource with type 'Microsoft.Storage/storageAccounts' doesn't have 'supportsHttpsTrafficOnly' set to true"
				}
			]
		},
		{
			"query_name": "Storage Blob Service Container With Public Access",
			"query_id": "a0ab985d-660b-41f7-ac81-70957ee8e627",
			"query_url": "https://docs.microsoft.com/en-us/azure/templates/microsoft.storage/storageaccounts/blobservices/containers?tabs=json#containerproperties-object",
			"severity": "HIGH",
			"platform": "AzureResourceManager",
			"category": "Networking and Firewall",
			"description": "Storage Blob Service Container should not publicly accessible",
			"description_id": "49e52e15",
			"cis_description_id": "CIS Security - CIS Microsoft Azure Foundations Benchmark v1.3.1 - Rule 3.5",
			"cis_description_title": "Ensure that 'Public access level' is set to Private for blob containers",
			"cis_description_text": "Disable anonymous access to blob containers and disallow blob public access on storage account.\nAnonymous, public read access to a container and its blobs can be enabled in Azure Blob storage. It grants read-only access to these resources without sharing the account key, and without requiring a shared access signature. It is recommended not to provide anonymous access to blob containers until, and unless, it is strongly desired. A shared access signature token should be used for providing controlled and timed access to blob containers.If no anonymous access is needed on the storage account, it’s recommended to set allowBlobPublicAccess false.",
			"files": [
				{
					"file_name": "arm\\example_StorageBlobServiceContainerPrivateAccess\\storageBlobServiceContainerPrivateAccess-FAILED.json",
					"similarity_id": "1803bca09b42f0850beb0bab42eedcb312da73a7678836b55121f9ac9a2a49b1",
					"line": 46,
					"issue_type": "IncorrectValue",
					"search_key": "resources.name=[parameters('storageAccountName')].resources.name=[concat('default/', parameters('containerName'))].properties.publicAccess",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'blobServices/containers' doesn't have 'publicAccess' property set to 'Container' or 'Blob'",
					"actual_value": "resource with type 'blobServices/containers' has 'publicAccess' property set to 'Container'"
				}
			]
		},
		{
			"query_name": "Trusted Microsoft Services Not Enabled",
			"query_id": "e25b56cd-a4d6-498f-ab92-e6296a082097",
			"query_url": "https://docs.microsoft.com/en-us/azure/templates/microsoft.storage/storageaccounts?tabs=json#networkruleset-object",
			"severity": "HIGH",
			"platform": "AzureResourceManager",
			"category": "Networking and Firewall",
			"description": "Trusted Microsoft Services should be enabled for Storage Account access",
			"description_id": "88ca11b3",
			"cis_description_id": "CIS Security - CIS Microsoft Azure Foundations Benchmark v1.3.1 - Rule 3.7",
			"cis_description_title": "Ensure 'Trusted Microsoft Services' is enabled for Storage Account access",
			"cis_description_text": "Some Microsoft services that interact with storage accounts operate from networks that can't be granted access through network rules. To help this type of service work as intended, allow the set of trusted Microsoft services to bypass the network rules. These services will then use strong authentication to access the storage account. If the Allow trusted Microsoft services exception is enabled, the following services: Azure Backup, Azure Site Recovery, Azure DevTest Labs, Azure Event Grid, Azure Event Hubs, Azure Networking, Azure Monitor and Azure SQL Data Warehouse (when registered in the subscription), are granted access to the storage account.\nTurning on firewall rules for storage account will block access to incoming requests for data, including from other Azure services. This includes using the Portal, writing logs, etc. We can re-enable functionality. The customer can get access to services like Monitor, Networking, Hubs, and Event Grid by enabling \"Trusted Microsoft Services\" through exceptions. Also, Backup and Restore of Virtual Machines using unmanaged disks in storage accounts with network rules applied is supported via creating an exception.",
			"files": [
				{
					"file_name": "arm\\example_StorageAccountAzureServicesAccessEnabled\\storageAccountAzureServicesAccessEnabled-FAILED.json",
					"similarity_id": "36859b165311a5589fa26e7461f7172fe689252eebc5940961d757bd35f0fe4f",
					"line": 216,
					"issue_type": "IncorrectValue",
					"search_key": "resources.name=[variables('storageAccountName')].properties.networkAcls",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Storage/storageAccounts' has 'Trusted Microsoft Services' enabled",
					"actual_value": "resource with type 'Microsoft.Storage/storageAccounts' doesn't have 'Trusted Microsoft Services' enabled"
				}
			]
		},
		{
			"query_name": "Web App Not Using TLS Last Version",
			"query_id": "b5c851d5-00f1-43dc-a8de-3218fd6f71be",
			"query_url": "https://docs.microsoft.com/en-us/azure/templates/microsoft.web/sites?tabs=json#siteconfig-object",
			"severity": "HIGH",
			"platform": "AzureResourceManager",
			"category": "Encryption",
			"description": "Resources of type 'Microsoft.Web/sites' should define 'properties.siteConfig.minTlsVersion' with '1.2'",
			"description_id": "b5c851d5a",
			"cis_description_id": "CIS Security - CIS Microsoft Azure Foundations Benchmark v1.3.1 - Rule 9.3",
			"cis_description_title": "Ensure web app is using the latest version of TLS encryption",
			"cis_description_text": "The TLS(Transport Layer Security) protocol secures transmission of data over the internet using standard encryption technology. Encryption should be set with the latest version of TLS. App service allows TLS 1.2 by default, which is the recommended TLS level by industry standards, such as PCI DSS.\nApp service currently allows the web app to set TLS versions 1.0, 1.1 and 1.2. It is highly recommended to use the latest TLS 1.2 version for web app secure connections.",
			"files": [
				{
					"file_name": "arm\\example_AppServiceAuthentication\\appServiceAuthentication-FAILED.json",
					"similarity_id": "92ad19627d5468ef9a2907d2bb567525ee97d80e50118626047c937b12b76db3",
					"line": 56,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name=[variables('webAppPortalName')]",
					"search_line": 0,
					"search_value": "",
					"expected_value": "'siteConfig.minTlsVersion' is 1.2",
					"actual_value": "'siteConfig.minTlsVersion' is undefined"
				},
				{
					"file_name": "arm\\example_AppServiceClientCertificate\\appServiceClientCertificate-FAILED.json",
					"similarity_id": "b5dfb926c9200c8b573d741d7858ca0451d14e4378eae68a17aa11c6f15f5beb",
					"line": 56,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name=[variables('webAppPortalName')]",
					"search_line": 0,
					"search_value": "",
					"expected_value": "'siteConfig.minTlsVersion' is 1.2",
					"actual_value": "'siteConfig.minTlsVersion' is undefined"
				},
				{
					"file_name": "arm\\example_AppServiceMinTLSVersion\\appServiceMinTLSVersion-FAILED.json",
					"similarity_id": "650588366f44aebe81dec9720e8880c884cbfc208abe1851182d7e2778899925",
					"line": 55,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name=default",
					"search_line": 0,
					"search_value": "",
					"expected_value": "'siteConfig.minTlsVersion' is 1.2",
					"actual_value": "'siteConfig.minTlsVersion' is undefined"
				},
				{
					"file_name": "arm\\example_PostgreSQLServerLogCheckpointsEnabled\\postgreSQL-LogCheckpointsEnabled-FAILED.json",
					"similarity_id": "a49872a70408c47b1ffb5e91e60fb6c95ce5263be4d80a6e623d3c0160082c06",
					"line": 135,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name=[parameters('siteName')]",
					"search_line": 0,
					"search_value": "",
					"expected_value": "'siteConfig.minTlsVersion' is 1.2",
					"actual_value": "'siteConfig.minTlsVersion' is undefined"
				},
				{
					"file_name": "arm\\example_AppServiceIdentity\\appServiceIdentity-FAILED.json",
					"similarity_id": "d46e3eb062cacf0b0d8bb5ba5743c62f06b16ace62233519b741322491fc0966",
					"line": 56,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name=[variables('webAppPortalName')]",
					"search_line": 0,
					"search_value": "",
					"expected_value": "'siteConfig.minTlsVersion' is 1.2",
					"actual_value": "'siteConfig.minTlsVersion' is undefined"
				},
				{
					"file_name": "arm\\example_PostgreSQLServerLogConnectionsEnabled\\postgreSQL-LogConnectionsEnabled-FAILED.json",
					"similarity_id": "83af5ec37ace918c93b856a907f928f4c0fc7ab7ae6c883379e3b63d7d4dda37",
					"line": 135,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name=[parameters('siteName')]",
					"search_line": 0,
					"search_value": "",
					"expected_value": "'siteConfig.minTlsVersion' is 1.2",
					"actual_value": "'siteConfig.minTlsVersion' is undefined"
				},
				{
					"file_name": "arm\\example_AppServiceHttps20Enabled\\appServiceHttps20Enabled-FAILED.json",
					"similarity_id": "ccec68a53d8ad9ba986b1d679615f9df7fe235689d70930ad36704f587d5d423",
					"line": 56,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name=default",
					"search_line": 0,
					"search_value": "",
					"expected_value": "'siteConfig.minTlsVersion' is 1.2",
					"actual_value": "'siteConfig.minTlsVersion' is undefined"
				},
				{
					"file_name": "arm\\example_PostgreSQLServerConnectionThrottlingEnabled\\postgreSQL-ConnectionThrottlingEnabled-FAILED.json",
					"similarity_id": "de8f9e046d44f4dec32787c6bc726bed402689a59cbd392197e6de566a07ee52",
					"line": 135,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name=[parameters('siteName')]",
					"search_line": 0,
					"search_value": "",
					"expected_value": "'siteConfig.minTlsVersion' is 1.2",
					"actual_value": "'siteConfig.minTlsVersion' is undefined"
				},
				{
					"file_name": "arm\\example_AppServiceHTTPSOnly\\appServiceHTTPSOnly-FAILED.json",
					"similarity_id": "8209f2dc326b13b538981a793bc0378dfce27234fe17ab6b3ee99d6f1b2a908f",
					"line": 56,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name=[variables('webAppPortalName')]",
					"search_line": 0,
					"search_value": "",
					"expected_value": "'siteConfig.minTlsVersion' is 1.2",
					"actual_value": "'siteConfig.minTlsVersion' is undefined"
				}
			]
		},
		{
			"query_name": "Website Not Forcing HTTPS",
			"query_id": "488847ff-6031-487c-bf42-98fd6ac5c9a0",
			"query_url": "https://docs.microsoft.com/en-us/azure/templates/microsoft.web/sites?tabs=json#siteproperties-object",
			"severity": "HIGH",
			"platform": "AzureResourceManager",
			"category": "Insecure Configurations",
			"description": "'Microsoft.Web/sites' should force the use of HTTPS",
			"description_id": "3af52329",
			"cis_description_id": "CIS Security - CIS Microsoft Azure Foundations Benchmark v1.3.1 - Rule 9.2",
			"cis_description_title": "Ensure web app redirects all HTTP traffic to HTTPS in Azure App Service",
			"cis_description_text": "Azure Web Apps allows sites to run under both HTTP and HTTPS by default. Web apps can be accessed by anyone using non-secure HTTP links by default.Non-secure HTTP requests can be restricted and all HTTP requests redirected to the secure HTTPS port. It is recommended to enforce HTTPS-only traffic.\nEnabling HTTPS-only traffic will redirect all non-secure HTTP request to HTTPS ports. HTTPS uses the SSL/TLS protocol to provide a secure connection, which is both encrypted and authenticated. So it is important to support HTTPS for the security benefits.",
			"files": [
				{
					"file_name": "arm\\example_AppServiceHTTPSOnly\\appServiceHTTPSOnly-FAILED.json",
					"similarity_id": "979fa354c674dfe5fb2acc2a0e19804ebcf31f8c9eb5c34e7a9bdfcbc3ad6a7b",
					"line": 62,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{[variables('webAppPortalName')]}}.properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Web/sites' has the 'httpsOnly' property defined",
					"actual_value": "resource with type 'Microsoft.Web/sites' doesn't have 'httpsOnly' property defined"
				},
				{
					"file_name": "arm\\example_AppServiceClientCertificate\\appServiceClientCertificate-FAILED.json",
					"similarity_id": "23e7e9981ce68b507d823fc9afd3d5cec3c66667cb93dbadee31029e4a43e952",
					"line": 62,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{[variables('webAppPortalName')]}}.properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Web/sites' has the 'httpsOnly' property defined",
					"actual_value": "resource with type 'Microsoft.Web/sites' doesn't have 'httpsOnly' property defined"
				},
				{
					"file_name": "arm\\example_PostgreSQLServerConnectionThrottlingEnabled\\postgreSQL-ConnectionThrottlingEnabled-FAILED.json",
					"similarity_id": "fdc9318332d9a48561e5da8f8eb17054c6edd696d617f71046c31be7f3780880",
					"line": 141,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{[parameters('siteName')]}}.properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Web/sites' has the 'httpsOnly' property defined",
					"actual_value": "resource with type 'Microsoft.Web/sites' doesn't have 'httpsOnly' property defined"
				},
				{
					"file_name": "arm\\example_PostgreSQLServerLogConnectionsEnabled\\postgreSQL-LogConnectionsEnabled-FAILED.json",
					"similarity_id": "197413a1d42e60722d21ca24a11b26a27a2b5e8ea8b2aee156d7533d278f271a",
					"line": 141,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{[parameters('siteName')]}}.properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Web/sites' has the 'httpsOnly' property defined",
					"actual_value": "resource with type 'Microsoft.Web/sites' doesn't have 'httpsOnly' property defined"
				},
				{
					"file_name": "arm\\example_PostgreSQLServerLogCheckpointsEnabled\\postgreSQL-LogCheckpointsEnabled-FAILED.json",
					"similarity_id": "4639cd1bd5e12b561ecc48bff695e328492302a7f8b0ceb85e45b092055097b1",
					"line": 141,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{[parameters('siteName')]}}.properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Web/sites' has the 'httpsOnly' property defined",
					"actual_value": "resource with type 'Microsoft.Web/sites' doesn't have 'httpsOnly' property defined"
				},
				{
					"file_name": "arm\\example_AppServiceAuthentication\\appServiceAuthentication-FAILED.json",
					"similarity_id": "e7ecd51a2ad370b77d53aaf22dd5fccf22b9b5ab5329a08936ad5efda4a0ded4",
					"line": 62,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{[variables('webAppPortalName')]}}.properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Web/sites' has the 'httpsOnly' property defined",
					"actual_value": "resource with type 'Microsoft.Web/sites' doesn't have 'httpsOnly' property defined"
				},
				{
					"file_name": "arm\\example_AppServiceMinTLSVersion\\appServiceMinTLSVersion-FAILED.json",
					"similarity_id": "684d90462b43c0c9efbb579c7c8fd2774548855d42c4fbe71ccd56531870f525",
					"line": 61,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{default}}.properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Web/sites' has the 'httpsOnly' property defined",
					"actual_value": "resource with type 'Microsoft.Web/sites' doesn't have 'httpsOnly' property defined"
				},
				{
					"file_name": "arm\\example_AppServiceIdentity\\appServiceIdentity-FAILED.json",
					"similarity_id": "48d1b2ea2f13f9050fa2d3b121f827b675423548c1138eb7e61cf5ba1fd12436",
					"line": 62,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{[variables('webAppPortalName')]}}.properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Web/sites' has the 'httpsOnly' property defined",
					"actual_value": "resource with type 'Microsoft.Web/sites' doesn't have 'httpsOnly' property defined"
				},
				{
					"file_name": "arm\\example_AppServiceHttps20Enabled\\appServiceHttps20Enabled-FAILED.json",
					"similarity_id": "681a9dfa1563e9a2e2bf52bacb29da9228ff745d2a51cfb3e16e9c2d82ce5223",
					"line": 62,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{default}}.properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Web/sites' has the 'httpsOnly' property defined",
					"actual_value": "resource with type 'Microsoft.Web/sites' doesn't have 'httpsOnly' property defined"
				}
			]
		},
		{
			"query_name": "Website with Client Certificate Auth Disabled",
			"query_id": "92302b47-b0cc-46cb-a28f-5610ecda140b",
			"query_url": "https://docs.microsoft.com/en-us/azure/templates/microsoft.web/sites?tabs=json#siteproperties-object",
			"severity": "HIGH",
			"platform": "AzureResourceManager",
			"category": "Networking and Firewall",
			"description": "'Microsoft.Web/sites' should have client certificate authentication enabled",
			"description_id": "1b3c50da",
			"cis_description_id": "CIS Security - CIS Microsoft Azure Foundations Benchmark v1.3.1 - Rule 9.4",
			"cis_description_title": "Ensure the web app has 'Client Certificates (Incoming client certificates)' set to 'On'",
			"cis_description_text": "Client certificates allow for the app to request a certificate for incoming requests. Only clients that have a valid certificate will be able to reach the app.\nThe TLS mutual authentication technique in enterprise environments ensures the authenticity of clients to the server. If incoming client certificates are enabled, then only an authenticated client who has valid certificates can access the app.",
			"files": [
				{
					"file_name": "arm\\example_PostgreSQLServerLogCheckpointsEnabled\\postgreSQL-LogCheckpointsEnabled-FAILED.json",
					"similarity_id": "634fcfe8e8902f501fbb1efbdab73352cfc1232d1de1ee80266f2c4ad2634b46",
					"line": 141,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{[parameters('siteName')]}}.properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Web/sites' has the 'clientCertEnabled' property defined",
					"actual_value": "resource with type 'Microsoft.Web/sites' doesn't have 'clientCertEnabled' property defined"
				},
				{
					"file_name": "arm\\example_AppServiceMinTLSVersion\\appServiceMinTLSVersion-FAILED.json",
					"similarity_id": "97480e56e74b68891672ba6f9f98f0eef99b8f69492dbf5c542242ded3ba240a",
					"line": 61,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{default}}.properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Web/sites' has the 'clientCertEnabled' property defined",
					"actual_value": "resource with type 'Microsoft.Web/sites' doesn't have 'clientCertEnabled' property defined"
				},
				{
					"file_name": "arm\\example_PostgreSQLServerConnectionThrottlingEnabled\\postgreSQL-ConnectionThrottlingEnabled-FAILED.json",
					"similarity_id": "0f79de596166a5876536b39154b76f23ff6d662f435df8ddf871713188cf291f",
					"line": 141,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{[parameters('siteName')]}}.properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Web/sites' has the 'clientCertEnabled' property defined",
					"actual_value": "resource with type 'Microsoft.Web/sites' doesn't have 'clientCertEnabled' property defined"
				},
				{
					"file_name": "arm\\example_AppServiceHttps20Enabled\\appServiceHttps20Enabled-FAILED.json",
					"similarity_id": "e09c5f4010239397871c446eda1f02aeca1f1c22c45266e8a8efec5b2ed75327",
					"line": 62,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{default}}.properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Web/sites' has the 'clientCertEnabled' property defined",
					"actual_value": "resource with type 'Microsoft.Web/sites' doesn't have 'clientCertEnabled' property defined"
				},
				{
					"file_name": "arm\\example_AppServiceHTTPSOnly\\appServiceHTTPSOnly-FAILED.json",
					"similarity_id": "3802d6b4be479640bf8bf05323f279a1325595f43de5ad035399de8f8694745f",
					"line": 62,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{[variables('webAppPortalName')]}}.properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Web/sites' has the 'clientCertEnabled' property defined",
					"actual_value": "resource with type 'Microsoft.Web/sites' doesn't have 'clientCertEnabled' property defined"
				},
				{
					"file_name": "arm\\example_AppServiceClientCertificate\\appServiceClientCertificate-FAILED.json",
					"similarity_id": "8ffb80f23e82c6e9bed48282ef648d9f86d165a21b4c379629e54c0293ff9842",
					"line": 62,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{[variables('webAppPortalName')]}}.properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Web/sites' has the 'clientCertEnabled' property defined",
					"actual_value": "resource with type 'Microsoft.Web/sites' doesn't have 'clientCertEnabled' property defined"
				},
				{
					"file_name": "arm\\example_AppServiceAuthentication\\appServiceAuthentication-FAILED.json",
					"similarity_id": "7245580497e5f6e87ab9809e98ea24c80eeaf1006beaed076a39b8038b7fa937",
					"line": 62,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{[variables('webAppPortalName')]}}.properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Web/sites' has the 'clientCertEnabled' property defined",
					"actual_value": "resource with type 'Microsoft.Web/sites' doesn't have 'clientCertEnabled' property defined"
				},
				{
					"file_name": "arm\\example_PostgreSQLServerLogConnectionsEnabled\\postgreSQL-LogConnectionsEnabled-FAILED.json",
					"similarity_id": "720e02843f72a10b1688a792111553a08c8b4e43e33515b34d36924820813209",
					"line": 141,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{[parameters('siteName')]}}.properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Web/sites' has the 'clientCertEnabled' property defined",
					"actual_value": "resource with type 'Microsoft.Web/sites' doesn't have 'clientCertEnabled' property defined"
				},
				{
					"file_name": "arm\\example_AppServiceIdentity\\appServiceIdentity-FAILED.json",
					"similarity_id": "c777c7c96f504c5087b3dedd091d38070a6af177a53c89bfeebeb9c5983f096c",
					"line": 62,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{[variables('webAppPortalName')]}}.properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Web/sites' has the 'clientCertEnabled' property defined",
					"actual_value": "resource with type 'Microsoft.Web/sites' doesn't have 'clientCertEnabled' property defined"
				}
			]
		},
		{
			"query_name": "AKS Cluster Network Policy Not Configured",
			"query_id": "25c0228e-4444-459b-a2df-93c7df40b7ed",
			"query_url": "https://docs.microsoft.com/en-us/azure/templates/microsoft.containerservice/managedclusters?tabs=json#containerservicenetworkprofile-object",
			"severity": "MEDIUM",
			"platform": "AzureResourceManager",
			"category": "Insecure Configurations",
			"description": "Azure Kubernetes Service must have a network policy defined.",
			"description_id": "25c0df8e",
			"files": [
				{
					"file_name": "arm\\example_AKSApiServerAuthorizedIpRanges\\aks-authIPRanges-preview-FAILED.json",
					"similarity_id": "3b58f5f919e18287467c6d7c553de1ac3b3568d39ed5dc678afce030214b94bb",
					"line": 90,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name=[parameters('clusterName')]",
					"search_line": 0,
					"search_value": "",
					"expected_value": "'networkProfile.networkPolicy' is defined and not empty",
					"actual_value": "'networkProfile.networkPolicy' is undefined"
				},
				{
					"file_name": "arm\\example_AKSDashboardDisabled\\AKSDashboardDisabled-FAILED.json",
					"similarity_id": "6f8222ee94da6857037fe1744e218545c60d692067e270ebc3747a38177c29e6",
					"line": 90,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name=[parameters('clusterName')]",
					"search_line": 0,
					"search_value": "",
					"expected_value": "'networkProfile.networkPolicy' is defined and not empty",
					"actual_value": "'networkProfile.networkPolicy' is undefined"
				},
				{
					"file_name": "arm\\example_AKSRbacEnabled\\aksEnableRbac-FAILED.json",
					"similarity_id": "7647f796adfc30f2c7436b39c573a1e5f5cba6d319b65044cb358d63de5edb19",
					"line": 275,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name=[variables('aksName')]",
					"search_line": 0,
					"search_value": "",
					"expected_value": "'networkProfile.networkPolicy' is defined and not empty",
					"actual_value": "'networkProfile.networkPolicy' is undefined"
				},
				{
					"file_name": "arm\\example_AKSLoggingEnabled\\aksLoggingEnabled-FAILED.json",
					"similarity_id": "a64761d55b1d5044241f0cd02c69087af424a6e8dad29c3b4e8a00f35d760e27",
					"line": 275,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name=[variables('aksName')]",
					"search_line": 0,
					"search_value": "",
					"expected_value": "'networkProfile.networkPolicy' is defined and not empty",
					"actual_value": "'networkProfile.networkPolicy' is undefined"
				},
				{
					"file_name": "arm\\example_AKSNetworkPolicy\\aksNetworkPolicy-FAILED.json",
					"similarity_id": "2378d0c921a73b000e76e7f753888bc998a24294f790635eca10a9a44e4ea32a",
					"line": 275,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name=[variables('aksName')]",
					"search_line": 0,
					"search_value": "",
					"expected_value": "'networkProfile.networkPolicy' is defined and not empty",
					"actual_value": "'networkProfile.networkPolicy' is undefined"
				}
			]
		},
		{
			"query_name": "AKS Cluster RBAC Disabled",
			"query_id": "9307a2ed-35c2-413d-94de-a1a0682c2158",
			"query_url": "https://docs.microsoft.com/en-us/azure/templates/microsoft.containerservice/managedclusters?tabs=json",
			"severity": "MEDIUM",
			"platform": "AzureResourceManager",
			"category": "Access Control",
			"description": "Microsoft.ContainerService/managedClusters should have enableRBAC set to true",
			"description_id": "b07ac0d6",
			"cis_description_id": "CIS Security - CIS Microsoft Azure Foundations Benchmark v1.3.1 - Rule 8.5",
			"cis_description_title": "Enable role-based access control (RBAC) within Azure Kubernetes Services",
			"cis_description_text": "Ensure that RBAC is enabled on all Azure Kubernetes Services Instances\nAzure Kubernetes Services has the capability to integrate Azure Active Directory users and groups into Kubernetes RBAC controls within the AKS Kubernetes API Server. This should be utilized to enable granular access to Kubernetes resources within the AKS clusters supporting RBAC controls not just of the overarching AKS instance but also the individual resources managed within Kubernetes.",
			"files": [
				{
					"file_name": "arm\\example_AKSDashboardDisabled\\AKSDashboardDisabled-FAILED.json",
					"similarity_id": "d42bea2108e86158e4339e95a1944ae5c240bc5021dbb23aa3f2601f1a41f167",
					"line": 91,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{[parameters('clusterName')]}}.properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.ContainerService/managedClusters' has the 'enableRBAC' property defined",
					"actual_value": "resource with type 'Microsoft.ContainerService/managedClusters' doesn't have 'enableRBAC' property defined"
				},
				{
					"file_name": "arm\\example_AKSNetworkPolicy\\aksNetworkPolicy-FAILED.json",
					"similarity_id": "2c33269ae39fbbd2a93eb6e58f0795aa0fbc3c59e674ce1e4c8d45fe161301da",
					"line": 276,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{[variables('aksName')]}}.properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.ContainerService/managedClusters' has the 'enableRBAC' property defined",
					"actual_value": "resource with type 'Microsoft.ContainerService/managedClusters' doesn't have 'enableRBAC' property defined"
				},
				{
					"file_name": "arm\\example_AKSLoggingEnabled\\aksLoggingEnabled-FAILED.json",
					"similarity_id": "d82da4bf412464719cf501269c0cf94599992d3048cd8ec45e2b7670467f4694",
					"line": 276,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{[variables('aksName')]}}.properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.ContainerService/managedClusters' has the 'enableRBAC' property defined",
					"actual_value": "resource with type 'Microsoft.ContainerService/managedClusters' doesn't have 'enableRBAC' property defined"
				},
				{
					"file_name": "arm\\example_AKSApiServerAuthorizedIpRanges\\aks-authIPRanges-preview-FAILED.json",
					"similarity_id": "0040b370768dc574a7af4aeec7a7cb2b3693122099cf86a52cb78bf0360806e1",
					"line": 91,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{[parameters('clusterName')]}}.properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.ContainerService/managedClusters' has the 'enableRBAC' property defined",
					"actual_value": "resource with type 'Microsoft.ContainerService/managedClusters' doesn't have 'enableRBAC' property defined"
				},
				{
					"file_name": "arm\\example_AKSRbacEnabled\\aksEnableRbac-FAILED.json",
					"similarity_id": "8ceeeffbfbacedf192d4470b46464de1bc61d423678386e9e0d6ab0ca8393c73",
					"line": 276,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{[variables('aksName')]}}.properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.ContainerService/managedClusters' has the 'enableRBAC' property defined",
					"actual_value": "resource with type 'Microsoft.ContainerService/managedClusters' doesn't have 'enableRBAC' property defined"
				}
			]
		},
		{
			"query_name": "AKS Logging To Azure Monitoring Is Disabled",
			"query_id": "9b09dee1-f09b-4013-91d2-158fa4695f4b",
			"query_url": "https://docs.microsoft.com/en-us/azure/templates/microsoft.containerservice/managedclusters?tabs=json#managedclusteraddonprofile",
			"severity": "MEDIUM",
			"platform": "AzureResourceManager",
			"category": "Observability",
			"description": "Azure Kubernetes Service should have logging to Azure Monitoring enabled.",
			"description_id": "9b09c3e1",
			"files": [
				{
					"file_name": "arm\\example_AKSApiServerAuthorizedIpRanges\\aks-authIPRanges-preview-FAILED.json",
					"similarity_id": "e3b87b9ed20f6f259dfd40e8a81fcae4138d0325a1348540a9d9da8665a7a01f",
					"line": 90,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name=[parameters('clusterName')]",
					"search_line": 0,
					"search_value": "",
					"expected_value": "'addonProfiles.omsagent.enabled' is defined and false",
					"actual_value": "'addonProfiles.omsagent.enabled' is undefined"
				},
				{
					"file_name": "arm\\example_AKSRbacEnabled\\aksEnableRbac-FAILED.json",
					"similarity_id": "a67a0e7a2437b1b581c1f13230f5c394d9accd2ecaafc539d19c3df12d1ea1ee",
					"line": 275,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name=[variables('aksName')]",
					"search_line": 0,
					"search_value": "",
					"expected_value": "'addonProfiles.omsagent.enabled' is defined and false",
					"actual_value": "'addonProfiles.omsagent.enabled' is undefined"
				},
				{
					"file_name": "arm\\example_AKSDashboardDisabled\\AKSDashboardDisabled-FAILED.json",
					"similarity_id": "f541ad06fd6385a82e565d541759b52db77b3e86b151ddab5e4c45ade35478be",
					"line": 90,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name=[parameters('clusterName')]",
					"search_line": 0,
					"search_value": "",
					"expected_value": "'addonProfiles.omsagent.enabled' is defined and false",
					"actual_value": "'addonProfiles.omsagent.enabled' is undefined"
				},
				{
					"file_name": "arm\\example_AKSNetworkPolicy\\aksNetworkPolicy-FAILED.json",
					"similarity_id": "e88f5d8477b260c41e11bc46e2c27dc20c6368fe83e4f8cbe0741b8df6d91010",
					"line": 275,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name=[variables('aksName')]",
					"search_line": 0,
					"search_value": "",
					"expected_value": "'addonProfiles.omsagent.enabled' is defined and false",
					"actual_value": "'addonProfiles.omsagent.enabled' is undefined"
				},
				{
					"file_name": "arm\\example_AKSLoggingEnabled\\aksLoggingEnabled-FAILED.json",
					"similarity_id": "cacd4ef1ef405bb3a241a263a8c7935410b9f9e0ce2311ddf48347b52710a0ac",
					"line": 275,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name=[variables('aksName')]",
					"search_line": 0,
					"search_value": "",
					"expected_value": "'addonProfiles.omsagent.enabled' is defined and false",
					"actual_value": "'addonProfiles.omsagent.enabled' is undefined"
				}
			]
		},
		{
			"query_name": "AKS With Authorized IP Ranges Disabled",
			"query_id": "2583fab1-953b-4fae-bd02-4a136a6c21f9",
			"query_url": "https://docs.microsoft.com/en-us/azure/templates/microsoft.containerservice/managedclusters?tabs=json#managedclusterapiserveraccessprofile-object",
			"severity": "MEDIUM",
			"platform": "AzureResourceManager",
			"category": "Networking and Firewall",
			"description": "Azure Kubernetes Service must have an authorized IP range for API Services enabled",
			"description_id": "258efab1",
			"files": [
				{
					"file_name": "arm\\example_AKSLoggingEnabled\\aksLoggingEnabled-FAILED.json",
					"similarity_id": "97747d0e8716288977bdc2f31f71457ddc3684a60c15aeccca3aa4d5f4f57a5a",
					"line": 272,
					"issue_type": "IncorrectValue",
					"search_key": "resources.name=[variables('aksName')].apiVersion",
					"search_line": 0,
					"search_value": "",
					"expected_value": "'apiVersion' is '2019-02-01' or newer",
					"actual_value": "'apiVersion' is 2017-08-31"
				},
				{
					"file_name": "arm\\example_AKSRbacEnabled\\aksEnableRbac-FAILED.json",
					"similarity_id": "e1ab4eecc71a0590f9761410ef4b0e444c08fcfae930d63147a0208f303b3736",
					"line": 272,
					"issue_type": "IncorrectValue",
					"search_key": "resources.name=[variables('aksName')].apiVersion",
					"search_line": 0,
					"search_value": "",
					"expected_value": "'apiVersion' is '2019-02-01' or newer",
					"actual_value": "'apiVersion' is 2017-08-31"
				},
				{
					"file_name": "arm\\example_AKSNetworkPolicy\\aksNetworkPolicy-FAILED.json",
					"similarity_id": "c3ba50483979ef5944eddedcd9b542d13c2cb494e576518def944f4a18cd8f03",
					"line": 272,
					"issue_type": "IncorrectValue",
					"search_key": "resources.name=[variables('aksName')].apiVersion",
					"search_line": 0,
					"search_value": "",
					"expected_value": "'apiVersion' is '2019-02-01' or newer",
					"actual_value": "'apiVersion' is 2017-08-31"
				},
				{
					"file_name": "arm\\example_AKSApiServerAuthorizedIpRanges\\aks-authIPRanges-preview-FAILED.json",
					"similarity_id": "03bfdef76d16b087e1e40178e240c134d8946f9b102019b9de6bcaef0b5cf209",
					"line": 90,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name=[parameters('clusterName')]",
					"search_line": 0,
					"search_value": "",
					"expected_value": "'apiServerAuthorizedIPRanges' is a defined as an array",
					"actual_value": "'apiServerAuthorizedIPRanges' is undefined"
				},
				{
					"file_name": "arm\\example_AKSDashboardDisabled\\AKSDashboardDisabled-FAILED.json",
					"similarity_id": "75654d5fff6ee134ee5fc24dd6d29fc5c2c1047ac854fe33ce038f8a97c1fdf9",
					"line": 90,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name=[parameters('clusterName')]",
					"search_line": 0,
					"search_value": "",
					"expected_value": "'apiServerAccessProfile.authorizedIPRanges' is defined as an array",
					"actual_value": "'apiServerAccessProfile.authorizedIPRanges' is undefined"
				}
			]
		},
		{
			"query_name": "PostgresSQL Database Server Connection Throttling Disabled",
			"query_id": "a6d774b6-d9ea-4bf4-8433-217bf15d2fb8",
			"query_url": "https://docs.microsoft.com/en-us/azure/templates/microsoft.dbforpostgresql/servers/configurations?tabs=json",
			"severity": "MEDIUM",
			"platform": "AzureResourceManager",
			"category": "Networking and Firewall",
			"description": "Microsoft.DBforPostgreSQL/servers/configurations should have 'connection_throttling' property set to 'on'",
			"description_id": "2eb0e3a8",
			"cis_description_id": "CIS Security - CIS Microsoft Azure Foundations Benchmark v1.3.1 - Rule 4.3.6",
			"cis_description_title": "Ensure server parameter 'connection_throttling' is set to 'ON' for PostgreSQL Database Server",
			"cis_description_text": "Enable connection_throttling on PostgreSQL Servers .\nEnabling connection_throttling helps the PostgreSQL Database to Set the verbosity of logged messages which in turn generates query and error logs with respect to concurrent connections, that could lead to a successful Denial of Service (DoS) attack by exhausting connection resources. A system can also fail or be degraded by an overload of legitimate users. Query and error logs can be used to identify, troubleshoot, and repair configuration errors and sub-optimal performance.",
			"files": [
				{
					"file_name": "arm\\example_PostgreSQLServerLogConnectionsEnabled\\postgreSQL-LogConnectionsEnabled-FAILED.json",
					"similarity_id": "1a25407d9f8f08ea83cb797504ff2ad244cea4eb22a9f3398644f06a23e80d76",
					"line": 166,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name=[variables('serverName')]",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource '[variables('serverName')]' has an 'auditingsettings' resource enabled",
					"actual_value": "resource '[variables('serverName')]' doesn't have an 'auditingsettings' resource enabled"
				},
				{
					"file_name": "arm\\example_PostgreSQLServerSSLEnforcementEnabled\\postgreSQL-SSL-FAILED.json",
					"similarity_id": "b98cfe6ca06c8be86323300e97da1689d9f74b82232623570058c55d293dbfb9",
					"line": 180,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name=[parameters('serverName')]",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource '[parameters('serverName')]' has an 'auditingsettings' resource enabled",
					"actual_value": "resource '[parameters('serverName')]' doesn't have an 'auditingsettings' resource enabled"
				},
				{
					"file_name": "arm\\example_PostgreSQLServerConnectionThrottlingEnabled\\postgreSQL-ConnectionThrottlingEnabled-FAILED.json",
					"similarity_id": "8ec4345d676116af91318bf8c5ad7deae008715e4e84c3339dba5d94d3191e2f",
					"line": 211,
					"issue_type": "IncorrectValue",
					"search_key": "resources.resources.name=connection_throttling.properties.value",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource '[variables('serverName')]' has an 'auditingsettings' resource enabled",
					"actual_value": "resource '[variables('serverName')]' doesn't have an 'auditingsettings' resource enabled"
				},
				{
					"file_name": "arm\\example_PostgreSQLServerLogCheckpointsEnabled\\postgreSQL-LogCheckpointsEnabled-FAILED.json",
					"similarity_id": "0c74826da40b1ca33e7247b3653c8b60a4aae98ab97a194d49420f1c1105cb17",
					"line": 166,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name=[variables('serverName')]",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource '[variables('serverName')]' has an 'auditingsettings' resource enabled",
					"actual_value": "resource '[variables('serverName')]' doesn't have an 'auditingsettings' resource enabled"
				}
			]
		},
		{
			"query_name": "SQL Server Database Without Auditing",
			"query_id": "e055285c-bc01-48b4-8aa5-8a54acdd29df",
			"query_url": "https://docs.microsoft.com/en-us/azure/templates/microsoft.sql/servers/databases/auditingsettings",
			"severity": "MEDIUM",
			"platform": "AzureResourceManager",
			"category": "Observability",
			"description": "Every 'Microsoft.Sql/servers/databases' resource should have Auditing Enabled",
			"description_id": "16d077a1",
			"cis_description_id": "CIS Security - CIS Microsoft Azure Foundations Benchmark v1.3.1 - Rule 4.1.1",
			"cis_description_title": "Ensure that 'Auditing' is set to 'On'",
			"cis_description_text": "Enable auditing on SQL Servers.\nThe Azure platform allows a SQL server to be created as a service. Enabling auditing at the server level ensures that all existing and newly created databases on the SQL server instance are audited.Auditing policy applied on the SQL database does not override auditing policy and settings applied on the particular SQL server where the database is hosted. Auditing tracks database events and writes them to an audit log in the Azure storage account. It also helps to maintain regulatory compliance, understand database activity, and gain insight into discrepancies and anomalies that could indicate business concerns or suspected security violations.",
			"files": [
				{
					"file_name": "arm\\example_SQLServerAuditingEnabled\\sqlServerAuditingEnabled-TDE-FAILED.json",
					"similarity_id": "3d97d7b84d0d639a4dc7d3782415f5d1f81862e1d9f50ee3189f2a3f484bca3b",
					"line": 59,
					"issue_type": "MissingAttribute",
					"search_key": "resources.resources.name=[variables('databaseName')]",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource '[variables('databaseName')]' has an enabled 'auditingsettings' resource",
					"actual_value": "resource '[variables('databaseName')]' is missing an enabled 'auditingsettings' resource"
				},
				{
					"file_name": "arm\\example_PostgreSQLServerLogCheckpointsEnabled\\postgreSQL-LogCheckpointsEnabled-FAILED.json",
					"similarity_id": "140ab79a7385856d134abc0d47a47f9ea2a8db2aa1ff46a00c8e2d50b72a9350",
					"line": 195,
					"issue_type": "MissingAttribute",
					"search_key": "resources.resources.name=[variables('databaseName')]",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource '[variables('databaseName')]' has an enabled 'auditingsettings' resource",
					"actual_value": "resource '[variables('databaseName')]' is missing an enabled 'auditingsettings' resource"
				},
				{
					"file_name": "arm\\example_PostgreSQLServerConnectionThrottlingEnabled\\postgreSQL-ConnectionThrottlingEnabled-FAILED.json",
					"similarity_id": "8eca9a9283210ec6d6f0d84b9bb897ce305f0115d45b8cf1208f171184303375",
					"line": 195,
					"issue_type": "MissingAttribute",
					"search_key": "resources.resources.name=[variables('databaseName')]",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource '[variables('databaseName')]' has an enabled 'auditingsettings' resource",
					"actual_value": "resource '[variables('databaseName')]' is missing an enabled 'auditingsettings' resource"
				},
				{
					"file_name": "arm\\example_SQLServerNoPublicAccess\\sqlServerNoPublicAccess-TDE-FAILED.json",
					"similarity_id": "89d9d1186839e59e85d66ed2e896f79ba88494e4941e71e74e0b0dc292a9cd56",
					"line": 59,
					"issue_type": "MissingAttribute",
					"search_key": "resources.resources.name=[variables('databaseName')]",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource '[variables('databaseName')]' has an enabled 'auditingsettings' resource",
					"actual_value": "resource '[variables('databaseName')]' is missing an enabled 'auditingsettings' resource"
				},
				{
					"file_name": "arm\\example_SQLServerThreatDetectionTypes\\sqlServerThreatDetectionTypes-FAILED.json",
					"similarity_id": "80590ff8a0eda3f93e7ad45a55b44ca358f574f13805913ac32cbbe028b1e7f0",
					"line": 83,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name=[concat(string(variables('databaseServerName')), '/', string(variables('databaseNames')[copyIndex()]))]",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource '[concat(string(variables('databaseServerName')), '/', string(variables('databaseNames')[copyIndex()]))]' has an enabled 'auditingsettings' resource",
					"actual_value": "resource '[concat(string(variables('databaseServerName')), '/', string(variables('databaseNames')[copyIndex()]))]' is missing an enabled 'auditingsettings' resource"
				},
				{
					"file_name": "arm\\example_PostgreSQLServerLogConnectionsEnabled\\postgreSQL-LogConnectionsEnabled-FAILED.json",
					"similarity_id": "f0ab1bcba1f561626e2d7e7dd6ba4665706e3fe56c2a726d1ca5752985bc63c5",
					"line": 195,
					"issue_type": "MissingAttribute",
					"search_key": "resources.resources.name=[variables('databaseName')]",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource '[variables('databaseName')]' has an enabled 'auditingsettings' resource",
					"actual_value": "resource '[variables('databaseName')]' is missing an enabled 'auditingsettings' resource"
				},
				{
					"file_name": "arm\\example_SQLServerEmailAlertsToAdminsEnabled\\sqlServerEmailAlertsToAdminsEnabled-FAILED.json",
					"similarity_id": "a362247b4431b11023fe55fec75d6a83594aba1cc55fe52e828291245de2c51e",
					"line": 83,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name=[concat(string(variables('databaseServerName')), '/', string(variables('databaseNames')[copyIndex()]))]",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource '[concat(string(variables('databaseServerName')), '/', string(variables('databaseNames')[copyIndex()]))]' has an enabled 'auditingsettings' resource",
					"actual_value": "resource '[concat(string(variables('databaseServerName')), '/', string(variables('databaseNames')[copyIndex()]))]' is missing an enabled 'auditingsettings' resource"
				},
				{
					"file_name": "arm\\example_SQLServerEmailAlertsEnabled\\sqlServerEmailAlertsEnabled-FAILED.json",
					"similarity_id": "43fdf7aa464c6fd9713a21d22013bc1a7591a802ebd96d5830b6f9e5c1b7f22a",
					"line": 83,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name=[concat(string(variables('databaseServerName')), '/', string(variables('databaseNames')[copyIndex()]))]",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource '[concat(string(variables('databaseServerName')), '/', string(variables('databaseNames')[copyIndex()]))]' has an enabled 'auditingsettings' resource",
					"actual_value": "resource '[concat(string(variables('databaseServerName')), '/', string(variables('databaseNames')[copyIndex()]))]' is missing an enabled 'auditingsettings' resource"
				}
			]
		},
		{
			"query_name": "Standard Price Is Not Selected",
			"query_id": "2081c7d6-2851-4cce-bda5-cb49d462da42",
			"query_url": "https://docs.microsoft.com/en-us/azure/templates/microsoft.security/pricings?tabs=json#pricingproperties-object",
			"severity": "MEDIUM",
			"platform": "AzureResourceManager",
			"category": "Networking and Firewall",
			"description": "Azure Security Center provides more features for standard pricing mode, so it must be activated.",
			"description_id": "2081c7dc",
			"cis_description_id": "CIS Security - CIS Microsoft Azure Foundations Benchmark v1.3.1 - Rule 2.2",
			"cis_description_title": "Ensure that Azure Defender is set to On for App Service",
			"cis_description_text": "Turning on Azure Defender enables threat detection for App Service, providing threat intelligence, anomaly detection, and behavior analytics in the Azure Security Center.\nEnabling Azure Defender for App Service allows for greater defense-in-depth, with threat detection provided by the Microsoft Security Response Center (MSRC).",
			"files": [
				{
					"file_name": "arm\\example_SecurityCenter\\securityCenter-FAILED.json",
					"similarity_id": "7f196c72e8641a2be34b8d9e95b875773971ae7e00c308c77fe32ca3b3d51a53",
					"line": 83,
					"issue_type": "IncorrectValue",
					"search_key": "resources.name=SqlServers.properties.pricingTier",
					"search_line": 0,
					"search_value": "",
					"expected_value": "'pricingTier' is set to standard",
					"actual_value": "'pricingTier' is set to [parameters('pricing')]"
				},
				{
					"file_name": "arm\\example_SecurityCenter\\securityCenter-FAILED.json",
					"similarity_id": "7f196c72e8641a2be34b8d9e95b875773971ae7e00c308c77fe32ca3b3d51a53",
					"line": 83,
					"issue_type": "IncorrectValue",
					"search_key": "resources.name=AppServices.properties.pricingTier",
					"search_line": 0,
					"search_value": "",
					"expected_value": "'pricingTier' is set to standard",
					"actual_value": "'pricingTier' is set to [parameters('pricing')]"
				},
				{
					"file_name": "arm\\example_SecurityCenter\\securityCenter-FAILED.json",
					"similarity_id": "7f196c72e8641a2be34b8d9e95b875773971ae7e00c308c77fe32ca3b3d51a53",
					"line": 83,
					"issue_type": "IncorrectValue",
					"search_key": "resources.name=VirtualMachines.properties.pricingTier",
					"search_line": 0,
					"search_value": "",
					"expected_value": "'pricingTier' is set to standard",
					"actual_value": "'pricingTier' is set to [parameters('pricing')]"
				},
				{
					"file_name": "arm\\example_SecurityCenter\\securityCenter-FAILED.json",
					"similarity_id": "7f196c72e8641a2be34b8d9e95b875773971ae7e00c308c77fe32ca3b3d51a53",
					"line": 83,
					"issue_type": "IncorrectValue",
					"search_key": "resources.name=default.properties.pricingTier",
					"search_line": 0,
					"search_value": "",
					"expected_value": "'pricingTier' is set to standard",
					"actual_value": "'pricingTier' is set to [parameters('pricing')]"
				}
			]
		},
		{
			"query_name": "Storage Logging For Read Write And Delete Requests Disabled",
			"query_id": "43f6e60c-9cdb-4e77-864d-a66595d26518",
			"query_url": "https://docs.microsoft.com/pt-pt/azure/azure-monitor/essentials/resource-manager-diagnostic-settings#diagnostic-setting-for-azure-storage",
			"severity": "MEDIUM",
			"platform": "AzureResourceManager",
			"category": "Observability",
			"description": "Storage Logging should be enabled for read, write and delete methods",
			"description_id": "83fa7bb6",
			"cis_description_id": "CIS Security - CIS Microsoft Azure Foundations Benchmark v1.3.1 - Rule 3.3",
			"cis_description_title": "Ensure Storage logging is enabled for Queue service for read, write, and delete requests",
			"cis_description_text": "The Storage Queue service stores messages that may be read by any client who has access to the storage account. A queue can contain an unlimited number of messages, each of which can be up to 64KB in size using version 2011-08-18 or newer. Storage Logging happens server-side and allows details for both successful and failed requests to be recorded in the storage account. These logs allow users to see the details of read, write, and delete operations against the queues. Storage Logging log entries contain the following information about individual requests: Timing information such as start time, end-to-end latency, and server latency, authentication details , concurrency information and the sizes of the request and response messages.\nStorage Analytics logs contain detailed information about successful and failed requests to a storage service. This information can be used to monitor individual requests and to diagnose issues with a storage service. Requests are logged on a best-effort basis. Storage Analytics logging is not enabled by default for your storage account.",
			"files": [
				{
					"file_name": "arm\\example_StorageAccountLoggingQueueServiceEnabled\\exampleStorageAccountLoggingQueueServiceEnabled-Failed.json",
					"similarity_id": "6439e4b0c872c0bd0e8b8abe3ec2f4b9288c653bf8aa8d923dd7e87e3e69f15b",
					"line": 102,
					"issue_type": "IncorrectValue",
					"search_key": "resources.properties.template.resources.name=[concat(parameters('storageAccountName'),'/default/Microsoft.Insights/', parameters('settingName'))].properties.logs.StorageWrite",
					"search_line": 0,
					"search_value": "",
					"expected_value": "'diagnosticsettings.properties.logs.StorageWrite' is defined and enabled",
					"actual_value": "'diagnosticsettings.properties.logs.false' is %!s(MISSING)"
				}
			]
		},
		{
			"query_name": "AKS Dashboard Is Enabled",
			"query_id": "c62d3b92-9a11-4ffd-b7b7-6faaae83faed",
			"query_url": "https://docs.microsoft.com/en-us/azure/templates/microsoft.containerservice/managedclusters?tabs=json#managedclusteraddonprofile",
			"severity": "LOW",
			"platform": "AzureResourceManager",
			"category": "Best Practices",
			"description": "Azure Kubernetes Service should have the Kubernetes dashboard disabled.",
			"description_id": "c12d3b42",
			"files": [
				{
					"file_name": "arm\\example_AKSApiServerAuthorizedIpRanges\\aks-authIPRanges-preview-FAILED.json",
					"similarity_id": "f01c3a4cd59c0b9526ced07985dd9f1b8943618b60805d3b0a7e77e6e43dda5e",
					"line": 90,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name=[parameters('clusterName')]",
					"search_line": 0,
					"search_value": "",
					"expected_value": "'addonProfiles.kubeDashboard.enabled' is defined and false",
					"actual_value": "'addonProfiles.kubeDashboard.enabled' is undefined"
				},
				{
					"file_name": "arm\\example_AKSRbacEnabled\\aksEnableRbac-FAILED.json",
					"similarity_id": "6a74d7e50279906bcf254b01c5005c4663c59500c65a6fcba04fabe0fd7ed11c",
					"line": 275,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name=[variables('aksName')]",
					"search_line": 0,
					"search_value": "",
					"expected_value": "'addonProfiles.kubeDashboard.enabled' is defined and false",
					"actual_value": "'addonProfiles.kubeDashboard.enabled' is undefined"
				},
				{
					"file_name": "arm\\example_AKSDashboardDisabled\\AKSDashboardDisabled-FAILED.json",
					"similarity_id": "c317411049bcc8987d6c14ed3399a3f142ee484e142deca2005c1a073c0cae2e",
					"line": 90,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name=[parameters('clusterName')]",
					"search_line": 0,
					"search_value": "",
					"expected_value": "'addonProfiles.kubeDashboard.enabled' is defined and false",
					"actual_value": "'addonProfiles.kubeDashboard.enabled' is undefined"
				},
				{
					"file_name": "arm\\example_AKSLoggingEnabled\\aksLoggingEnabled-FAILED.json",
					"similarity_id": "55ab96f0075b4c7323299e2b2b3a628585ab0f270025d063d40533ffeed75012",
					"line": 275,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name=[variables('aksName')]",
					"search_line": 0,
					"search_value": "",
					"expected_value": "'addonProfiles.kubeDashboard.enabled' is defined and false",
					"actual_value": "'addonProfiles.kubeDashboard.enabled' is undefined"
				},
				{
					"file_name": "arm\\example_AKSNetworkPolicy\\aksNetworkPolicy-FAILED.json",
					"similarity_id": "374f9dd0086c0035150d46123db45585b43a80b062b8209fea358a0ee13fa935",
					"line": 275,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name=[variables('aksName')]",
					"search_line": 0,
					"search_value": "",
					"expected_value": "'addonProfiles.kubeDashboard.enabled' is defined and false",
					"actual_value": "'addonProfiles.kubeDashboard.enabled' is undefined"
				}
			]
		},
		{
			"query_name": "Phone Number Not Set For Security Contacts",
			"query_id": "3e9fcc67-1f64-405f-b2f9-0a6be17598f0",
			"query_url": "https://docs.microsoft.com/en-us/azure/templates/microsoft.security/securitycontacts?tabs=json",
			"severity": "LOW",
			"platform": "AzureResourceManager",
			"category": "Best Practices",
			"description": "Microsoft.Security securityContacts should have a phone number defined",
			"description_id": "8b9ef792",
			"files": [
				{
					"file_name": "arm\\example_SecurityCenter\\securityCenter-FAILED.json",
					"similarity_id": "979b6c700aea4984ff2df5fd1d25934a12708ccee4bb7310c636a6013b624d98",
					"line": 123,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{default1}}.properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Security/securityContacts' has 'phone' property defined",
					"actual_value": "resource with type 'Microsoft.Security/securityContacts' doesn't have 'phone' property defined"
				}
			]
		},
		{
			"query_name": "Storage Account Allows Default Network Access",
			"query_id": "9073f073-5d60-4b46-b569-0d6baa80ed95",
			"query_url": "https://docs.microsoft.com/en-us/azure/templates/microsoft.storage/storageaccounts?tabs=json#storageaccountpropertiescreateparameters-object",
			"severity": "LOW",
			"platform": "AzureResourceManager",
			"category": "Networking and Firewall",
			"description": "'Microsoft.Storage/storageAccounts' should force the use of HTTPS",
			"description_id": "6ae0507e",
			"cis_description_id": "CIS Security - CIS Microsoft Azure Foundations Benchmark v1.3.1 - Rule 3.6",
			"cis_description_title": "Ensure default network access rule for Storage Accounts is set to deny",
			"cis_description_text": "Restricting default network access helps to provide a new layer of security, since storage accounts accept connections from clients on any network. To limit access to selected networks, the default action must be changed.\nStorage accounts should be configured to deny access to traffic from all networks (including internet traffic). Access can be granted to traffic from specific Azure Virtual networks, allowing a secure network boundary for specific applications to be built. Access can also be granted to public internet IP address ranges, to enable connections from specific internet or on-premises clients. When network rules are configured, only applications from allowed networks can access a storage account. When calling from an allowed network, applications continue to require proper authorization (a valid access key or SAS token) to access the storage account.",
			"files": [
				{
					"file_name": "arm\\example_StorageAccountDefaultNetworkAccessDeny\\storageAccountDefaultNetworkAccessDeny-FAILED.json",
					"similarity_id": "06363e30917bbe1030548a4ba6cb0d9ebb4c38041126a46211f098fcde77faac",
					"line": 224,
					"issue_type": "IncorrectValue",
					"search_key": "resources.name=[variables('storageAccountName')].properties.networkAcls.defaultAction",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Storage/storageAccounts' has the 'properties.networkAcls.defaultAction' set to 'Deny'",
					"actual_value": "resource with type 'Microsoft.Storage/storageAccounts' has the 'properties.networkAcls.defaultAction' set to 'Allow'"
				},
				{
					"file_name": "arm\\example_NSGRuleSSHAccessRestricted\\NSGRulePortAccessRestricted-FAILED.json",
					"similarity_id": "7424aff9b9fe52c061f1960d7c824efabe787e647455bd6dcec45d05355241e1",
					"line": 156,
					"issue_type": "IncorrectValue",
					"search_key": "resources.name=[variables('jumpBoxSAName')].apiVersion=2015-06-15",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Storage/storageAccounts' apiVersion is newer than 2017 and enables setting networkAcls",
					"actual_value": "resource with type 'Microsoft.Storage/storageAccounts' apiVersion is older than 2017 and doesn't enable setting networkAcls"
				},
				{
					"file_name": "arm\\example_NSGRuleRDPAccessRestricted\\NSGRulePortAccessRestricted-FAILED.json",
					"similarity_id": "2d593b4d118e6ee25f76dc7a06142075ee4aab8c1b4db3465b6c71a14690b3a5",
					"line": 156,
					"issue_type": "IncorrectValue",
					"search_key": "resources.name=[variables('jumpBoxSAName')].apiVersion=2015-06-15",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Storage/storageAccounts' apiVersion is newer than 2017 and enables setting networkAcls",
					"actual_value": "resource with type 'Microsoft.Storage/storageAccounts' apiVersion is older than 2017 and doesn't enable setting networkAcls"
				},
				{
					"file_name": "arm\\example_StorageAccountsTransportEncryption\\storageAccount-FAILED.json",
					"similarity_id": "959a1caab01c7111bd5dd9f474b13c3ee3cba918b03931db3b1e502d35f55733",
					"line": 39,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name=[variables('storageAccountName')].properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Storage/storageAccounts' has the 'properties.networkAcls.defaultAction' defined",
					"actual_value": "resource with type 'Microsoft.Storage/storageAccounts' doesn't have 'properties.networkAcls.defaultAction' defined"
				},
				{
					"file_name": "arm\\example_StorageBlobServiceContainerPrivateAccess\\storageBlobServiceContainerPrivateAccess-FAILED.json",
					"similarity_id": "c52d468ea7734a0ac19cb6cf816a9c55a1011e9754274e239de3e792c11c2b5e",
					"line": 37,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name=[parameters('storageAccountName')].properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Storage/storageAccounts' has the 'properties.networkAcls.defaultAction' defined",
					"actual_value": "resource with type 'Microsoft.Storage/storageAccounts' doesn't have 'properties.networkAcls.defaultAction' defined"
				}
			]
		},
		{
			"query_name": "Website Azure Active Directory Disabled",
			"query_id": "e9c133e5-c2dd-4b7b-8fff-40f2de367b56",
			"query_url": "https://docs.microsoft.com/en-us/azure/templates/microsoft.web/2019-08-01/sites?tabs=json#ManagedServiceIdentity",
			"severity": "LOW",
			"platform": "AzureResourceManager",
			"category": "Access Control",
			"description": "WebApp should have Azure Active Directory  enabled with 'identity.type' set to 'SystemAssigned' or 'userAssignedIdentities' set to 'true'",
			"description_id": "f50ec4cb",
			"cis_description_id": "CIS Security - CIS Microsoft Azure Foundations Benchmark v1.3.1 - Rule 9.5",
			"cis_description_title": "Ensure that Register with Azure Active Directory is enabled on App Service",
			"cis_description_text": "Managed service identity in App Service makes the app more secure by eliminating secrets from the app, such as credentials in the connection strings. When registering with Azure Active Directory in the app service, the app will connect to other Azure services securely without the need of username and passwords.\nApp Service provides a highly scalable, self-patching web hosting service in Azure. It also provides a managed identity for apps, which is a turn-key solution for securing access to Azure SQL Database and other Azure services.",
			"files": [
				{
					"file_name": "arm\\example_AppServiceMinTLSVersion\\appServiceMinTLSVersion-FAILED.json",
					"similarity_id": "388d1fda58b90f7385d26a85ad6a90380718721d535fc99a8fb01d762d4ed8ec",
					"line": 40,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{default}}",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Web/sites' has the 'identity' property defined",
					"actual_value": "resource with type 'Microsoft.Web/sites' doesn't have 'identity' property defined"
				},
				{
					"file_name": "arm\\example_PostgreSQLServerLogCheckpointsEnabled\\postgreSQL-LogCheckpointsEnabled-FAILED.json",
					"similarity_id": "c82014746c4f2a2f4d5cc5b14e16210a85e124bf14351e7805e800a4446074fe",
					"line": 119,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{[parameters('siteName')]}}",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Web/sites' has the 'identity' property defined",
					"actual_value": "resource with type 'Microsoft.Web/sites' doesn't have 'identity' property defined"
				},
				{
					"file_name": "arm\\example_AppServiceAuthentication\\appServiceAuthentication-FAILED.json",
					"similarity_id": "3c12ccd6eb5b41ce51138994b6851e75fd234404028b48b8942e8b2542aff56f",
					"line": 41,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{[variables('webAppPortalName')]}}",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Web/sites' has the 'identity' property defined",
					"actual_value": "resource with type 'Microsoft.Web/sites' doesn't have 'identity' property defined"
				},
				{
					"file_name": "arm\\example_AppServiceHTTPSOnly\\appServiceHTTPSOnly-FAILED.json",
					"similarity_id": "04df3b1026b14e83f54290d1e4e7af801998193a5e29a255c3f3a3b76ebe4b43",
					"line": 41,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{[variables('webAppPortalName')]}}",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Web/sites' has the 'identity' property defined",
					"actual_value": "resource with type 'Microsoft.Web/sites' doesn't have 'identity' property defined"
				},
				{
					"file_name": "arm\\example_AppServiceClientCertificate\\appServiceClientCertificate-FAILED.json",
					"similarity_id": "b19791ba5f588fc877184ead6761d31e53d325bd33383bf6d7e4581e60110ea3",
					"line": 41,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{[variables('webAppPortalName')]}}",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Web/sites' has the 'identity' property defined",
					"actual_value": "resource with type 'Microsoft.Web/sites' doesn't have 'identity' property defined"
				},
				{
					"file_name": "arm\\example_PostgreSQLServerLogConnectionsEnabled\\postgreSQL-LogConnectionsEnabled-FAILED.json",
					"similarity_id": "934e98671d2b3882beb05483d7bce2ab8b23b7ae096de9ffd7218956c84cd3a1",
					"line": 119,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{[parameters('siteName')]}}",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Web/sites' has the 'identity' property defined",
					"actual_value": "resource with type 'Microsoft.Web/sites' doesn't have 'identity' property defined"
				},
				{
					"file_name": "arm\\example_PostgreSQLServerConnectionThrottlingEnabled\\postgreSQL-ConnectionThrottlingEnabled-FAILED.json",
					"similarity_id": "888d7783000554b8af45320d6228e7b8ba4fcae3113e9eb4421e307b6f15ba67",
					"line": 119,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{[parameters('siteName')]}}",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Web/sites' has the 'identity' property defined",
					"actual_value": "resource with type 'Microsoft.Web/sites' doesn't have 'identity' property defined"
				},
				{
					"file_name": "arm\\example_AppServiceHttps20Enabled\\appServiceHttps20Enabled-FAILED.json",
					"similarity_id": "befa2c60b7db0c6354a183bdac5d36da917bdec9314ee874b0add9c819d50f70",
					"line": 41,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{default}}",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Web/sites' has the 'identity' property defined",
					"actual_value": "resource with type 'Microsoft.Web/sites' doesn't have 'identity' property defined"
				},
				{
					"file_name": "arm\\example_AppServiceIdentity\\appServiceIdentity-FAILED.json",
					"similarity_id": "57f29958fa8d9982a61d1d339816a9423ff2f47eb741b65d7390003efa88ae12",
					"line": 41,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{[variables('webAppPortalName')]}}",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Web/sites' has the 'identity' property defined",
					"actual_value": "resource with type 'Microsoft.Web/sites' doesn't have 'identity' property defined"
				}
			]
		},
		{
			"query_name": "Website with 'Http20Enabled' Disabled",
			"query_id": "70111098-7f85-48f0-b1b4-e4261cf5f61b",
			"query_url": "https://docs.microsoft.com/en-us/azure/templates/microsoft.web/sites?tabs=json#siteproperties-object",
			"severity": "LOW",
			"platform": "AzureResourceManager",
			"category": "Networking and Firewall",
			"description": "'Microsoft.Web/sites' should have 'Http20Enabled' enabled",
			"description_id": "e0cdbc75",
			"cis_description_id": "CIS Security - CIS Microsoft Azure Foundations Benchmark v1.3.1 - Rule 9.9",
			"cis_description_title": "Ensure that 'HTTP Version' is the latest, if used to run the web app",
			"cis_description_text": "Periodically, newer versions are released for HTTP either due to security flaws or to include additional functionality. Using the latest HTTP version for web apps to take advantage of security fixes, if any, and/or new functionalities of the newer version.\nNewer versions may contain security enhancements and additional functionality. Using the latest version is recommended in order to take advantage of enhancements and new capabilities. With each software installation, organizations need to determine if a given update meets their requirements and also verify the compatibility and support provided for any additional software against the update revision that is selected. HTTP 2.0 has additional performance improvements on the head-of-line blocking problem of old HTTP version, header compression, and prioritization of requests. HTTP 2.0 no longer supports HTTP 1.1's chunked transfer encoding mechanism, as it provides its own, more efficient, mechanisms for data streaming.",
			"files": [
				{
					"file_name": "arm\\example_AppServiceAuthentication\\appServiceAuthentication-FAILED.json",
					"similarity_id": "958f1ea3dad7010a996ade364797cc9077c33ed34949b99da050169251fa1577",
					"line": 64,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{[variables('webAppPortalName')]}}.properties.siteConfig",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Web/sites' has the 'http20Enabled' property defined",
					"actual_value": "resource with type 'Microsoft.Web/sites' doesn't have 'http20Enabled' property defined"
				},
				{
					"file_name": "arm\\example_PostgreSQLServerLogConnectionsEnabled\\postgreSQL-LogConnectionsEnabled-FAILED.json",
					"similarity_id": "ed981727c87e43456076d022b63a547221f2a879fc5539a0ff12eb191ebd4de1",
					"line": 141,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{[parameters('siteName')]}}.properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Web/sites' has the 'siteConfig' property defined",
					"actual_value": "resource with type 'Microsoft.Web/sites' doesn't have 'siteConfig' property defined"
				},
				{
					"file_name": "arm\\example_PostgreSQLServerLogCheckpointsEnabled\\postgreSQL-LogCheckpointsEnabled-FAILED.json",
					"similarity_id": "bd92af69713341237065a3963c6a630e009da967c26df1572fdad4d4ce3e7a30",
					"line": 141,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{[parameters('siteName')]}}.properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Web/sites' has the 'siteConfig' property defined",
					"actual_value": "resource with type 'Microsoft.Web/sites' doesn't have 'siteConfig' property defined"
				},
				{
					"file_name": "arm\\example_AppServiceHTTPSOnly\\appServiceHTTPSOnly-FAILED.json",
					"similarity_id": "72a91fdc48aef2b95cba8db03fca44b1ace1d1e67d8cfe785ac4ebd2555695ef",
					"line": 64,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{[variables('webAppPortalName')]}}.properties.siteConfig",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Web/sites' has the 'http20Enabled' property defined",
					"actual_value": "resource with type 'Microsoft.Web/sites' doesn't have 'http20Enabled' property defined"
				},
				{
					"file_name": "arm\\example_AppServiceClientCertificate\\appServiceClientCertificate-FAILED.json",
					"similarity_id": "74c90c2cf5233db160f91e183df3ff27c7a4f72a6047805b01d38a5349f01721",
					"line": 64,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{[variables('webAppPortalName')]}}.properties.siteConfig",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Web/sites' has the 'http20Enabled' property defined",
					"actual_value": "resource with type 'Microsoft.Web/sites' doesn't have 'http20Enabled' property defined"
				},
				{
					"file_name": "arm\\example_AppServiceMinTLSVersion\\appServiceMinTLSVersion-FAILED.json",
					"similarity_id": "ef07761ff494edd8a3d99b06f7e69c330303c186afdcad9cc66076e7befe38a0",
					"line": 63,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{default}}.properties.siteConfig",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Web/sites' has the 'http20Enabled' property defined",
					"actual_value": "resource with type 'Microsoft.Web/sites' doesn't have 'http20Enabled' property defined"
				},
				{
					"file_name": "arm\\example_AppServiceHttps20Enabled\\appServiceHttps20Enabled-FAILED.json",
					"similarity_id": "29adce04c359163998052c975bf79aaa67b202c9c7263656a08482edcbe32217",
					"line": 64,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{default}}.properties.siteConfig",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Web/sites' has the 'http20Enabled' property defined",
					"actual_value": "resource with type 'Microsoft.Web/sites' doesn't have 'http20Enabled' property defined"
				},
				{
					"file_name": "arm\\example_AppServiceIdentity\\appServiceIdentity-FAILED.json",
					"similarity_id": "b4b7a2f574e53a5b37b333b415fd7b227dd2093ed3d2f92692473684661c4447",
					"line": 64,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{[variables('webAppPortalName')]}}.properties.siteConfig",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Web/sites' has the 'http20Enabled' property defined",
					"actual_value": "resource with type 'Microsoft.Web/sites' doesn't have 'http20Enabled' property defined"
				},
				{
					"file_name": "arm\\example_PostgreSQLServerConnectionThrottlingEnabled\\postgreSQL-ConnectionThrottlingEnabled-FAILED.json",
					"similarity_id": "c9fdf335fcc2682cdd91f617fe6253c09d8f3c34dc0812516a1abbea05b9fb85",
					"line": 141,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{[parameters('siteName')]}}.properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Web/sites' has the 'siteConfig' property defined",
					"actual_value": "resource with type 'Microsoft.Web/sites' doesn't have 'siteConfig' property defined"
				}
			]
		},
		{
			"query_name": "Account Admins Not Notified By Email",
			"query_id": "a8852cc0-fd4b-4fc7-9372-1e43fad0732e",
			"query_url": "https://docs.microsoft.com/en-us/azure/templates/microsoft.sql/2017-03-01-preview/servers/securityalertpolicies?tabs=json",
			"severity": "INFO",
			"platform": "AzureResourceManager",
			"category": "Best Practices",
			"description": "Account admins should be notified by email in the event of security alerts",
			"description_id": "f7c29c0d",
			"files": [
				{
					"file_name": "arm\\example_SQLServerEmailAlertsEnabled\\sqlServerEmailAlertsEnabled-FAILED.json",
					"similarity_id": "d9d20dc9a1c964d5d926c2833a5250e6d5c58721b518ce66389529f4c8afea98",
					"line": 98,
					"issue_type": "MissingAttribute",
					"search_key": "resources.resources.name={{default}}.properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "securityAlertPolicies.properties.emailAccountAdmins is set to true",
					"actual_value": "securityAlertPolicies.properties.emailAccountAdmins is missing"
				},
				{
					"file_name": "arm\\example_SQLServerEmailAlertsToAdminsEnabled\\sqlServerEmailAlertsToAdminsEnabled-FAILED.json",
					"similarity_id": "062ff21c891cc3bf1bcf80b4dbe72963f1c44cbaed2ddf7e260d52bc3f717baf",
					"line": 98,
					"issue_type": "MissingAttribute",
					"search_key": "resources.resources.name={{default}}.properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "securityAlertPolicies.properties.emailAccountAdmins is set to true",
					"actual_value": "securityAlertPolicies.properties.emailAccountAdmins is missing"
				},
				{
					"file_name": "arm\\example_SQLServerThreatDetectionTypes\\sqlServerThreatDetectionTypes-FAILED.json",
					"similarity_id": "c6119602307b98d5cd247b59447e8ffa1db95bdcf9aa5bbec1aa3659a1777eea",
					"line": 98,
					"issue_type": "MissingAttribute",
					"search_key": "resources.resources.name={{default}}.properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "securityAlertPolicies.properties.emailAccountAdmins is set to true",
					"actual_value": "securityAlertPolicies.properties.emailAccountAdmins is missing"
				}
			]
		},
		{
			"query_name": "App Service Authentication Is Not Set",
			"query_id": "83130a07-235b-4a80-918b-a370e53f0bd9",
			"query_url": "https://docs.microsoft.com/en-us/azure/templates/microsoft.web/sites/config-web?tabs=json",
			"severity": "INFO",
			"platform": "AzureResourceManager",
			"category": "Access Control",
			"description": "Azure App Service should have App Service Authentication set",
			"description_id": "831efa07",
			"cis_description_id": "CIS Security - CIS Microsoft Azure Foundations Benchmark v1.3.1 - Rule 9.1",
			"cis_description_title": "Ensure App Service Authentication is set on Azure App Service",
			"cis_description_text": "Azure App Service Authentication is a feature that can prevent anonymous HTTP requests from reaching the API app, or authenticate those that have tokens before they reach the API app. If an anonymous request is received from a browser, App Service will redirect to a logon page. To handle the logon process, a choice from a set of identity providers can be made, or a custom authentication mechanism can be implemented.\nBy Enabling App Service Authentication, every incoming HTTP request passes through it before being handled by the application code. It also handles authentication of users with the specified provider(Azure Active Directory, Facebook, Google, Microsoft Account, and Twitter), validation, storing and refreshing of tokens, managing the authenticated sessions and injecting identity information into request headers.",
			"files": [
				{
					"file_name": "arm\\example_AppServiceAuthentication\\appServiceAuthentication-FAILED.json",
					"similarity_id": "4fd44fe825a9ee16d6bf86168ec709c01046bd7b6420a46ff69ec978450a7b0c",
					"line": 74,
					"issue_type": "IncorrectValue",
					"search_key": "resources.name=[variables('webAppPortalName')].resources.name=authsettings.properties.enabled",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource authsettings has 'properties.enabled' property set to true",
					"actual_value": "'enabled' is false on authsettings properties"
				}
			]
		},
		{
			"query_name": "Email Notifications Disabled",
			"query_id": "79c2c2c0-eb00-47c0-ac16-f8b0e2c81c92",
			"query_url": "https://docs.microsoft.com/en-us/azure/templates/microsoft.security/securitycontacts",
			"severity": "INFO",
			"platform": "AzureResourceManager",
			"category": "Networking and Firewall",
			"description": "Email notifications about new security alerts, should be set to 'On', and be sent to persons with specific RBAC roles on the subscription",
			"description_id": "7f5b9ef4",
			"cis_description_id": "CIS Security - CIS Microsoft Azure Foundations Benchmark v1.3.1 - Rule 2.14",
			"cis_description_title": "Ensure that 'Notify about alerts with the following severity' is set to 'High'",
			"cis_description_text": "Enables emailing security alerts to the subscription owner or other designated security contact.\nEnabling security alert emails ensures that security alert emails are received from Microsoft. This ensures that the right people are aware of any potential security issues and are able to mitigate the risk.",
			"files": [
				{
					"file_name": "arm\\example_SecurityCenter\\securityCenter-FAILED.json",
					"similarity_id": "b9c1821e446e949b1a50eb97d90fb2637ff52345b33b64fee5ff059bd3598de0",
					"line": 125,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{default1}}.properties.alertNotifications",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Security/securityContacts' has 'alertNotifications.state' property set to 'On'",
					"actual_value": "resource with type 'Microsoft.Security/securityContacts' doesn't have 'alertNotifications.state' property defined"
				},
				{
					"file_name": "arm\\example_SecurityCenter\\securityCenter-FAILED.json",
					"similarity_id": "6e4196e3d8134e521e92faa79e60df004e109e74f2bd9ef63dccc8930205565a",
					"line": 123,
					"issue_type": "MissingAttribute",
					"search_key": "resources.name={{default1}}.properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "resource with type 'Microsoft.Security/securityContacts' has 'notificationsByRole.state' property set to 'On'",
					"actual_value": "resource with type 'Microsoft.Security/securityContacts' doesn't have 'notificationsByRole' property defined"
				}
			]
		},
		{
			"query_name": "SQL Alert Policy Without Emails",
			"query_id": "89b79fe5-49bd-4d39-84ce-55f5fc6f7764",
			"query_url": "https://docs.microsoft.com/en-us/azure/templates/microsoft.sql/servers/databases/securityalertpolicies?tabs=json",
			"severity": "INFO",
			"platform": "AzureResourceManager",
			"category": "Best Practices",
			"description": "SQL Database Server should contain emails to be notified in the event of a Security Alert",
			"description_id": "3b84ba2d",
			"files": [
				{
					"file_name": "arm\\example_SQLServerEmailAlertsToAdminsEnabled\\sqlServerEmailAlertsToAdminsEnabled-FAILED.json",
					"similarity_id": "571eeed626034a44b67842b3c50aae505cd3b6c33ee745474dd8227d453a2d48",
					"line": 98,
					"issue_type": "MissingAttribute",
					"search_key": "resources.resources.name={{default}}.properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "securityAlertPolicies.properties.emailAddresses is defined and contains emails",
					"actual_value": "securityAlertPolicies.properties.emailAddresses is not defined"
				},
				{
					"file_name": "arm\\example_SQLServerThreatDetectionTypes\\sqlServerThreatDetectionTypes-FAILED.json",
					"similarity_id": "0f8beb5d7e7fdedf4bcc25c79e6b23d8430cd6c2a80b235125c36a38f8f88a79",
					"line": 98,
					"issue_type": "MissingAttribute",
					"search_key": "resources.resources.name={{default}}.properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "securityAlertPolicies.properties.emailAddresses is defined and contains emails",
					"actual_value": "securityAlertPolicies.properties.emailAddresses is not defined"
				},
				{
					"file_name": "arm\\example_SQLServerEmailAlertsEnabled\\sqlServerEmailAlertsEnabled-FAILED.json",
					"similarity_id": "aa84ede3559f80414cd5ac5fb62e3626c893dae4c59e4aefdf7d59a4de21120f",
					"line": 98,
					"issue_type": "MissingAttribute",
					"search_key": "resources.resources.name={{default}}.properties",
					"search_line": 0,
					"search_value": "",
					"expected_value": "securityAlertPolicies.properties.emailAddresses is defined and contains emails",
					"actual_value": "securityAlertPolicies.properties.emailAddresses is not defined"
				}
			]
		}
	]
}
